/**
 * TestLCD.cc - testing of the laser corner detector
 * 
 * Copyright (C) 2003 David Austin
 * 
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of version 2 of the GNU General Public
 * License as published by the Free Software Foundation
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
 * 02111-1307, USA.
 * 
 * 
 * Longer description
 * 
 * 
 * @author  David Austin
 *          d.austin@computer.org
 *          Dept of Systems Engineering,
 *          Research School of Information Sciences and Engineering,
 *          Australian National University,
 *          Canberra, 0200, Australia.
 *
 * @version 
 *   $Id: TestLCD.cc,v 1.12 2003/09/13 12:23:41 david Exp $ 
 */

#ifndef DEPEND
#include <stdio.h>
#endif /* !DEPEND */
#include "LaserCornerDetectorMain.h"
#include "DROSDebug.h"
#include "DROSDefines.h"
#include "AngleTools.h"

typedef struct {
  int type;
  double x;
  double y;
  double prob;
} result_t;


double test0x[361] = {
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 
  1.0000, 0.9750, 0.9056, 0.8362, 0.7668, 
  0.6972, 0.6277, 0.5581, 0.4884, 0.4187, 
  0.3490, 0.2792, 0.2094, 0.1396, 0.0698, 
  0.0000, -0.0698, -0.1396, -0.2094, -0.2792, 
  -0.3490, -0.4187, -0.4884, -0.5581, -0.6277, 
  -0.6972, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7100, -0.7100, -0.7100, -0.7100, 
  -0.7100, -0.7153, -0.7294, -0.7439, -0.7589, 
  -0.7742, -0.7901, -0.8064, -0.8233, -0.8407, 
  -0.8587, -0.8773, -0.8965, -0.9165, -0.9372, 
  -0.9586, -0.9809, -1.0040, -1.0280, -1.0531, 
  -1.0792, -1.1064, -1.1348, -1.1645, -1.1956, 
  -1.2281, -1.2623, -1.2982, -1.3359, -1.3757, 
  -1.4177, -1.4621, -1.5090, -1.5589, -1.6118, 
  -1.6682, -1.7284, -1.7928, -1.8619, -1.9362, 
  -2.0163, -2.1030, -2.1971, -2.2996, -2.4118, 
  -2.5351, -2.6712, -2.8222, -2.9909, -3.1806, 
  -3.3953, -3.6405, -3.9233, -4.2529, -4.6423, 
  -5.1092, -5.6797, -6.3924, -7.9100, -7.9100, 
  -7.9100, -7.9100, -7.9100, -7.9100, -7.9100, 
  -7.9100
};

double test0y[361] = {
  0.0000, 0.0087, 0.0175, 0.0262, 0.0349, 
  0.0437, 0.0524, 0.0612, 0.0699, 0.0787, 
  0.0875, 0.0963, 0.1051, 0.1139, 0.1228, 
  0.1317, 0.1405, 0.1495, 0.1584, 0.1673, 
  0.1763, 0.1853, 0.1944, 0.2035, 0.2126, 
  0.2217, 0.2309, 0.2401, 0.2493, 0.2586, 
  0.2679, 0.2773, 0.2867, 0.2962, 0.3057, 
  0.3153, 0.3249, 0.3346, 0.3443, 0.3541, 
  0.3640, 0.3739, 0.3839, 0.3939, 0.4040, 
  0.4142, 0.4245, 0.4348, 0.4452, 0.4557, 
  0.4663, 0.4770, 0.4877, 0.4986, 0.5095, 
  0.5206, 0.5317, 0.5430, 0.5543, 0.5658, 
  0.5774, 0.5890, 0.6009, 0.6128, 0.6249, 
  0.6371, 0.6494, 0.6619, 0.6745, 0.6873, 
  0.7002, 0.7133, 0.7265, 0.7400, 0.7536, 
  0.7673, 0.7813, 0.7954, 0.8098, 0.8243, 
  0.8391, 0.8541, 0.8693, 0.8847, 0.9004, 
  0.9163, 0.9325, 0.9490, 0.9657, 0.9827, 
  1.0000, 1.0176, 1.0355, 1.0538, 1.0724, 
  1.0913, 1.1106, 1.1303, 1.1504, 1.1708, 
  1.1918, 1.2131, 1.2349, 1.2572, 1.2799, 
  1.3032, 1.3270, 1.3514, 1.3764, 1.4019, 
  1.4281, 1.4550, 1.4826, 1.5108, 1.5399, 
  1.5697, 1.6003, 1.6319, 1.6643, 1.6977, 
  1.7321, 1.7675, 1.8040, 1.8418, 1.8807, 
  1.9210, 1.9626, 2.0057, 2.0503, 2.0965, 
  2.1445, 2.1943, 2.2460, 2.2998, 2.3559, 
  2.4142, 2.4751, 2.5386, 2.6051, 2.6746, 
  2.7475, 2.8239, 2.9042, 2.9887, 3.0777, 
  3.1716, 3.2709, 3.3759, 3.4874, 3.6059, 
  3.7321, 3.8667, 4.0108, 4.1653, 4.3315, 
  4.5107, 4.7046, 4.9152, 5.1446, 5.3955, 
  5.6713, 5.9758, 6.3138, 6.6912, 7.1154, 
  7.5958, 7.9404, 7.9486, 7.9562, 7.9632, 
  7.9696, 7.9753, 7.9805, 7.9851, 7.9890, 
  7.9924, 7.9951, 7.9973, 7.9988, 7.9997, 
  8.0000, 7.9997, 7.9988, 7.9973, 7.9951, 
  7.9924, 7.9890, 7.9851, 7.9805, 7.9753, 
  7.9696, 7.3736, 6.7552, 6.2316, 5.7825, 
  5.3930, 5.0519, 4.7507, 4.4828, 4.2428, 
  4.0266, 3.8308, 3.6526, 3.4898, 3.3403, 
  3.2026, 3.0753, 2.9574, 2.8477, 2.7454, 
  2.6498, 2.5602, 2.4761, 2.3969, 2.3223, 
  2.2518, 2.1852, 2.1220, 2.0620, 2.0050, 
  1.9507, 1.8990, 1.8496, 1.8024, 1.7573, 
  1.7141, 1.6727, 1.6329, 1.5947, 1.5580, 
  1.5226, 1.4885, 1.4557, 1.4240, 1.3935, 
  1.3639, 1.3353, 1.3077, 1.2809, 1.2549, 
  1.2298, 1.2053, 1.1816, 1.1586, 1.1362, 
  1.1145, 1.0933, 1.0727, 1.0526, 1.0331, 
  1.0140, 0.9954, 0.9772, 0.9595, 0.9422, 
  0.9253, 0.9088, 0.8926, 0.8768, 0.8613, 
  0.8461, 0.8313, 0.8168, 0.8025, 0.7885, 
  0.7748, 0.7614, 0.7482, 0.7352, 0.7225, 
  0.7100, 0.6977, 0.6856, 0.6738, 0.6621, 
  0.6506, 0.6393, 0.6282, 0.6172, 0.6064, 
  0.5958, 0.5853, 0.5749, 0.5648, 0.5547, 
  0.5448, 0.5350, 0.5254, 0.5158, 0.5064, 
  0.4971, 0.4880, 0.4789, 0.4699, 0.4611, 
  0.4523, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4470, 0.4470, 
  0.4470, 0.4470, 0.4470, 0.4838, 0.4145, 
  0.3454, 0.2762, 0.2071, 0.1381, 0.0690, 
  0.0000
};

result_t results0[] = {
  {DROS_CORNER_CONVEX, -0.710, 0.447, 0.4},
  {0, 0.0, 0.0, 0.0}
};

double test1x[361] = {
  0.9897, 0.9872, 1.0206, 1.0033, 0.9845, 
  0.9768, 0.9966, 1.0157, 1.0126, 0.9928, 
  1.0248, 0.9769, 1.0012, 0.9851, 1.0080, 
  1.0099, 0.9915, 1.0193, 1.0072, 0.9922, 
  0.9779, 1.0131, 1.0149, 1.0097, 1.0089, 
  1.0197, 0.9909, 1.0123, 0.9902, 1.0150, 
  0.9850, 1.0044, 0.9785, 0.9809, 0.9836, 
  0.9878, 0.9827, 1.0042, 0.9791, 1.0184, 
  1.0209, 0.9792, 1.0198, 0.9986, 0.9887, 
  1.0040, 0.9848, 1.0039, 0.9989, 1.0144, 
  1.0193, 1.0012, 1.0037, 1.0103, 0.9878, 
  0.9895, 1.0059, 1.0017, 0.9789, 1.0188, 
  0.9934, 0.9873, 1.0010, 0.9958, 0.9918, 
  1.0076, 1.0061, 0.9976, 0.9904, 1.0084, 
  0.9932, 0.9884, 1.0105, 0.9903, 1.0073, 
  0.9808, 1.0136, 1.0138, 1.0039, 0.9931, 
  1.0064, 1.0010, 1.0131, 0.9906, 0.9909, 
  0.9843, 1.0005, 1.0141, 1.0040, 1.0011, 
  1.0114, 1.0161, 1.0082, 0.9946, 0.9952, 
  0.9846, 0.9841, 0.9836, 0.9996, 0.9933, 
  1.0067, 1.0102, 1.0002, 0.9990, 0.9870, 
  0.9906, 0.9995, 1.0126, 0.9866, 0.9879, 
  0.9927, 1.0060, 1.0031, 0.9888, 1.0126, 
  1.0099, 0.9912, 0.9994, 1.0066, 1.0070, 
  0.9877, 1.0019, 1.0057, 1.0058, 1.0099, 
  0.9907, 1.0065, 1.0100, 0.9913, 0.9952, 
  0.9945, 1.0064, 0.9918, 1.0049, 0.9956, 
  0.9937, 1.0082, 1.0048, 0.9928, 1.0084, 
  1.0059, 0.9974, 1.0031, 0.9993, 0.9990, 
  1.0023, 0.9974, 1.0014, 0.9949, 0.9944, 
  0.9984, 0.9955, 1.0019, 0.9955, 1.0043, 
  1.0009, 0.9970, 1.0017, 1.0003, 0.9983, 
  1.0038, 1.0022, 0.9970, 0.9966, 1.0001, 
  0.9993, 0.9750, 0.9056, 0.8362, 0.7668, 
  0.6972, 0.6277, 0.5581, 0.4884, 0.4187, 
  0.3490, 0.2792, 0.2094, 0.1396, 0.0698, 
  0.0000, -0.0698, -0.1396, -0.2094, -0.2792, 
  -0.3490, -0.4187, -0.4884, -0.5581, -0.6277, 
  -0.6972, -0.7086, -0.7098, -0.7081, -0.7088, 
  -0.7096, -0.7066, -0.7111, -0.7071, -0.7097, 
  -0.7064, -0.7126, -0.7127, -0.7118, -0.7143, 
  -0.7140, -0.7051, -0.7047, -0.7103, -0.7060, 
  -0.7155, -0.7048, -0.7085, -0.7114, -0.7120, 
  -0.7130, -0.7106, -0.7085, -0.7152, -0.7113, 
  -0.7172, -0.7051, -0.7152, -0.7077, -0.7078, 
  -0.7023, -0.7160, -0.7078, -0.7150, -0.7190, 
  -0.7174, -0.7171, -0.7147, -0.7130, -0.7104, 
  -0.7129, -0.7101, -0.7119, -0.7142, -0.6984, 
  -0.7164, -0.7125, -0.7007, -0.7007, -0.7019, 
  -0.7175, -0.7194, -0.7165, -0.7012, -0.7147, 
  -0.7046, -0.6985, -0.7214, -0.6982, -0.7094, 
  -0.7030, -0.7008, -0.7034, -0.7150, -0.7242, 
  -0.7011, -0.7102, -0.7191, -0.7245, -0.6980, 
  -0.7031, -0.7121, -0.7150, -0.7230, -0.7006, 
  -0.7162, -0.7146, -0.7220, -0.7214, -0.7200, 
  -0.6926, -0.7134, -0.7144, -0.7200, -0.7204, 
  -0.7017, -0.6937, -0.7248, -0.6972, -0.6974, 
  -0.7044, -0.7077, -0.7051, -0.7160, -0.6937, 
  -0.7029, -0.7252, -0.7145, -0.6935, -0.7228, 
  -0.7205, -0.7111, -0.7238, -0.7394, -0.7490, 
  -0.7785, -0.7713, -0.8240, -0.8203, -0.8575, 
  -0.8664, -0.8755, -0.8953, -0.9072, -0.9247, 
  -0.9471, -0.9843, -0.9949, -1.0109, -1.0645, 
  -1.0782, -1.1057, -1.1205, -1.1812, -1.1784, 
  -1.2184, -1.2474, -1.2747, -1.3549, -1.3657, 
  -1.4324, -1.4693, -1.5180, -1.5433, -1.5899, 
  -1.6904, -1.7417, -1.7740, -1.8795, -1.9219, 
  -2.0404, -2.1047, -2.2053, -2.2979, -2.4279, 
  -2.5544, -2.6816, -2.8176, -2.9758, -3.1973, 
  -3.3782, -3.6491, -3.9145, -4.2453, -4.6439, 
  -5.1071, -5.6867, -6.4032, -7.9080, -7.9121, 
  -7.8853, -7.8984, -7.8946, -7.9197, -7.9072, 
  -7.8968
};
double test1y[361] = {
  0.0000, 0.0086, 0.0178, 0.0263, 0.0344, 
  0.0426, 0.0522, 0.0621, 0.0708, 0.0781, 
  0.0897, 0.0941, 0.1052, 0.1122, 0.1238, 
  0.1330, 0.1393, 0.1523, 0.1595, 0.1660, 
  0.1724, 0.1878, 0.1973, 0.2054, 0.2144, 
  0.2261, 0.2288, 0.2430, 0.2469, 0.2625, 
  0.2639, 0.2785, 0.2806, 0.2906, 0.3007, 
  0.3115, 0.3193, 0.3360, 0.3371, 0.3606, 
  0.3716, 0.3661, 0.3915, 0.3933, 0.3995, 
  0.4159, 0.4180, 0.4365, 0.4447, 0.4623, 
  0.4753, 0.4775, 0.4895, 0.5037, 0.5033, 
  0.5151, 0.5348, 0.5439, 0.5426, 0.5764, 
  0.5735, 0.5816, 0.6014, 0.6102, 0.6198, 
  0.6419, 0.6534, 0.6603, 0.6681, 0.6930, 
  0.6954, 0.7050, 0.7342, 0.7328, 0.7591, 
  0.7526, 0.7919, 0.8064, 0.8130, 0.8187, 
  0.8445, 0.8550, 0.8807, 0.8764, 0.8922, 
  0.9019, 0.9330, 0.9624, 0.9696, 0.9838, 
  1.0114, 1.0340, 1.0440, 1.0481, 1.0672, 
  1.0745, 1.0929, 1.1118, 1.1499, 1.1630, 
  1.1997, 1.2254, 1.2352, 1.2559, 1.2633, 
  1.2910, 1.3264, 1.3684, 1.3579, 1.3850, 
  1.4177, 1.4637, 1.4872, 1.4939, 1.5592, 
  1.5852, 1.5862, 1.6308, 1.6753, 1.7096, 
  1.7107, 1.7709, 1.8144, 1.8525, 1.8994, 
  1.9031, 1.9754, 2.0257, 2.0324, 2.0864, 
  2.1327, 2.2084, 2.2275, 2.3112, 2.3456, 
  2.3991, 2.4954, 2.5508, 2.5863, 2.6972, 
  2.7637, 2.8164, 2.9133, 2.9866, 3.0746, 
  3.1789, 3.2624, 3.3808, 3.4696, 3.5857, 
  3.7262, 3.8491, 4.0185, 4.1466, 4.3500, 
  4.5147, 4.6905, 4.9234, 5.1460, 5.3863, 
  5.6931, 5.9890, 6.2951, 6.6683, 7.1161, 
  7.5908, 7.9404, 7.9486, 7.9562, 7.9632, 
  7.9696, 7.9753, 7.9805, 7.9851, 7.9890, 
  7.9924, 7.9951, 7.9973, 7.9988, 7.9997, 
  8.0000, 7.9997, 7.9988, 7.9973, 7.9951, 
  7.9924, 7.9890, 7.9851, 7.9805, 7.9753, 
  7.9696, 7.3593, 6.7528, 6.2147, 5.7730, 
  5.3897, 5.0274, 4.7581, 4.4643, 4.2409, 
  4.0061, 3.8446, 3.6667, 3.4988, 3.3604, 
  3.2205, 3.0540, 2.9353, 2.8490, 2.7297, 
  2.6704, 2.5414, 2.4707, 2.4015, 2.3289, 
  2.2614, 2.1870, 2.1175, 2.0772, 2.0086, 
  1.9705, 1.8859, 1.8631, 1.7966, 1.7518, 
  1.6955, 1.6868, 1.6277, 1.6060, 1.5777, 
  1.5384, 1.5035, 1.4654, 1.4301, 1.3942, 
  1.3694, 1.3354, 1.3111, 1.2884, 1.2344, 
  1.2408, 1.2096, 1.1662, 1.1434, 1.1233, 
  1.1262, 1.1077, 1.0825, 1.0395, 1.0399, 
  1.0063, 0.9793, 0.9929, 0.9435, 0.9414, 
  0.9162, 0.8969, 0.8843, 0.8829, 0.8785, 
  0.8355, 0.8316, 0.8273, 0.8188, 0.7752, 
  0.7673, 0.7636, 0.7534, 0.7487, 0.7130, 
  0.7162, 0.7022, 0.6972, 0.6845, 0.6714, 
  0.6347, 0.6423, 0.6321, 0.6258, 0.6153, 
  0.5888, 0.5718, 0.5869, 0.5546, 0.5448, 
  0.5405, 0.5333, 0.5218, 0.5202, 0.4948, 
  0.4921, 0.4984, 0.4819, 0.4590, 0.4694, 
  0.4590, 0.4443, 0.4435, 0.4443, 0.4412, 
  0.4495, 0.4364, 0.4567, 0.4454, 0.4559, 
  0.4510, 0.4461, 0.4464, 0.4425, 0.4411, 
  0.4416, 0.4486, 0.4430, 0.4395, 0.4519, 
  0.4466, 0.4467, 0.4414, 0.4534, 0.4406, 
  0.4435, 0.4417, 0.4389, 0.4534, 0.4437, 
  0.4516, 0.4492, 0.4497, 0.4425, 0.4409, 
  0.4529, 0.4504, 0.4423, 0.4512, 0.4437, 
  0.4523, 0.4474, 0.4487, 0.4467, 0.4500, 
  0.4504, 0.4487, 0.4463, 0.4447, 0.4494, 
  0.4447, 0.4481, 0.4460, 0.4462, 0.4472, 
  0.4468, 0.4476, 0.4478, 0.4837, 0.4147, 
  0.3443, 0.2758, 0.2067, 0.1382, 0.0690, 
  0.0000
};

result_t results1[] = {
  {DROS_CORNER_CONVEX, -0.706, 0.450, 0.0},
  {0, 0.0, 0.0, 0.0}
};

double test2x[100] = {
  -5.0, -4.9, -4.8, -4.7, -4.6, -4.5, -4.4, -4.3, -4.2, -4.1,
  -4.0, -3.9, -3.8, -3.7, -3.6, -3.5, -3.4, -3.3, -3.2, -3.1,
  -3.0, -2.9, -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1,
  -2.0, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1,
  -1.0, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1,

  0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 
  1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 
  2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9,
  3.0, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9,
  4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9
};

double test2y[100] = {
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,

  6.0, 6.0, 6.0, 6.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0
};


double test3x[100] = {
  5.0, 4.9, 4.8, 4.7, 4.6, 4.5, 4.4, 4.3, 4.2, 4.1,
  4.0, 3.9, 3.8, 3.7, 3.6, 3.5, 3.4, 3.3, 3.2, 3.1,
  3.0, 2.9, 2.8, 2.7, 2.6, 2.5, 2.4, 2.3, 2.2, 2.1,
  2.0, 1.9, 1.8, 1.7, 1.6, 1.5, 1.4, 1.3, 1.2, 1.1,
  1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1,

  -0.0, -0.1, -0.2, -0.3, -0.4, -0.5, -0.6, -0.7, -0.8, -0.9, 
  -1.0, -1.1, -1.2, -1.3, -1.4, -1.5, -1.6, -1.7, -1.8, -1.9, 
  -2.0, -2.1, -2.2, -2.3, -2.4, -2.5, -2.6, -2.7, -2.8, -2.9,
  -3.0, -3.1, -3.2, -3.3, -3.4, -3.5, -3.6, -3.7, -3.8, -3.9,
  -4.0, -4.1, -4.2, -4.3, -4.4, -4.5, -4.6, -4.7, -4.8, -4.9
};
double test3y[100] = {
  5.0, 4.9, 4.8, 4.7, 4.6, 4.5, 4.4, 4.3, 4.2, 4.1,
  4.0, 3.9, 3.8, 3.7, 3.6, 3.5, 3.4, 3.3, 3.2, 3.1,
  3.0, 2.9, 2.8, 2.7, 2.6, 2.5, 2.4, 2.3, 2.2, 2.1,
  2.0, 1.9, 1.8, 1.7, 1.6, 1.5, 1.4, 1.3, 1.2, 1.1,
  1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1,

  0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 
  1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 
  2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 
  3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4.0, 4.1, 
  4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5.0, 5.1
};

result_t results3[] = {
  {DROS_CORNER_CONVEX, 0.1, 0.1, 0.5},
  {0, 0.0, 0.0, 0.0}
};

double test4x[100] = {
  5.0, 4.9, 4.8, 4.7, 4.6, 4.5, 4.4, 4.3, 4.2, 4.1,
  4.0, 3.9, 3.8, 3.7, 3.6, 3.5, 3.4, 3.3, 3.2, 3.1,
  3.0, 2.9, 2.8, 2.7, 2.6, 2.5, 2.4, 2.3, 2.2, 2.1,
  2.0, 1.9, 1.8, 1.7, 1.6, 1.5, 1.4, 1.3, 1.2, 1.1,
  1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1,

  -0.0, -0.1, -0.2, -0.3, -0.4, -0.5, -0.6, -0.7, -0.8, -0.9, 
  -1.0, -1.1, -1.2, -1.3, -1.4, -1.5, -1.6, -1.7, -1.8, -1.9, 
  -2.0, -2.1, -2.2, -2.3, -2.4, -2.5, -2.6, -2.7, -2.8, -2.9,
  -3.0, -3.1, -3.2, -3.3, -3.4, -3.5, -3.6, -3.7, -3.8, -3.9,
  -4.0, -4.1, -4.2, -4.3, -4.4, -4.5, -4.6, -4.7, -4.8, -4.9
};

double test4y[100] = {
  0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9,
  1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9,
  2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9,
  3.0, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9,
  4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9,

  5.0, 4.9, 4.8, 4.7, 4.6, 4.5, 4.4, 4.3, 4.2, 4.1,
  4.0, 3.9, 3.8, 3.7, 3.6, 3.5, 3.4, 3.3, 3.2, 3.1,
  3.0, 2.9, 2.8, 2.7, 2.6, 2.5, 2.4, 2.3, 2.2, 2.1,
  2.0, 1.9, 1.8, 1.7, 1.6, 1.5, 1.4, 1.3, 1.2, 1.1,
  1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1
};

result_t results4[] = {
  {DROS_CORNER_CONCAVE, 0.0, 5.0, 0.5},
  {0, 0.0, 0.0, 0.0}
};

double test5x[100] = {
  -5.0, -4.9, -4.8, -4.7, -4.6, -4.5, -4.4, -4.3, -4.2, -4.1,
  -4.0, -3.9, -3.8, -3.7, -3.6, -3.5, -3.4, -3.3, -3.2, -3.1,
  -3.0, -2.9, -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1,
  -2.0, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1,
  -1.0, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1,

  0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 
  1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 
  2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9,
  3.0, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9,
  4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9
};

double test5y[100] = {
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,

  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0
};

result_t results5[] = {
  {DROS_CORNER_CONVEX_HIDDEN, -0.1, 5.0, 0.2},
  {0, 0.0, 0.0, 0.0}
};

double test6x[100] = {
  -5.0, -4.9, -4.8, -4.7, -4.6, -4.5, -4.4, -4.3, -4.2, -4.1,
  -4.0, -3.9, -3.8, -3.7, -3.6, -3.5, -3.4, -3.3, -3.2, -3.1,
  -3.0, -2.9, -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1,
  -2.0, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1,
  -1.0, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1,

  0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 
  1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 
  2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9,
  3.0, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9,
  4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9
};

double test6y[100] = {
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,

  5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1,
  5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1,
  5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1,
  5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1,
  5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1, 5.1
};

result_t results6[] = {
  {DROS_CORNER_JUMP, -0.1, 5.05, 0.5},
  {0, 0.0, 0.0, 0.0}
};

double test7x[100] = {
  -5.0, -4.9, -4.8, -4.7, -4.6, -4.5, -4.4, -4.3, -4.2, -4.1,
  -4.0, -3.9, -3.8, -3.7, -3.6, -3.5, -3.4, -3.3, -3.2, -3.1,
  -3.0, -2.9, -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1,
  -2.0, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1,
  -1.0, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1,

  0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 
  1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 
  2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9,
  3.0, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9,
  4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9
};

double test7y[100] = {
  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,
  6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0,

  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
  5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0
};

result_t results7[] = {
  {DROS_CORNER_CONVEX_HIDDEN, 0.0, 5.0, 0.5},
  {0, 0.0, 0.0, 0.0}
};

double test8x[361] = { 
  0.263000, 0.294948, 0.295636, 0.309464, 0.324982, 
  0.340424, 0.377511, 0.363059, 0.369727, 0.383592, 
  0.397481, 0.410890, 0.424287, 0.446163, 0.533550, 
  0.551724, 0.570851, 0.591433, 0.610754, 0.638648, 
  0.915049, 0.948935, 0.575354, 0.586973, 0.598985, 
  0.611468, 0.625171, 0.595660, 0.569273, 0.573722, 
  0.585489, 0.595979, 0.609201, 0.621427, 1.210869, 
  1.247811, 1.274413, 1.315817, 1.655129, 1.719399, 
  0.554401, 0.555773, 0.552561, 0.552169, 0.559688, 
  0.567233, 0.574022, 0.580404, 0.587169, 0.594755, 
  0.602362, 1.790023, 1.788532, 1.793905, 1.787500, 
  1.583601, 1.829157, 1.855756, 1.612225, 1.648187, 
  1.579500, 1.591735, 1.587163, 1.588579, 1.668346, 
  1.908749, 2.147451, 2.227896, 1.821471, 1.783234, 
  1.815671, 1.895356, 3.039698, 0.543162, 0.545853, 
  0.547900, 0.543126, 5.359527, 5.417763, 5.473117, 
  5.528073, 5.582629, 5.634155, 5.690521, 5.741172, 
  0.474460, 0.473737, 0.478455, 0.481123, 0.476076, 
  0.477960, 0.479828, 0.483837, 0.483514, 0.480943, 
  0.482709, 0.479255, 0.476452, 0.478092, 0.477434, 
  0.479791, 0.473654, 0.456509, 0.431261, 0.409570, 
  0.420084, 0.401164, 0.402067, 0.411050, 0.397329, 
  0.401437, 0.398981, 0.398133, 0.397256, 0.401381, 
  0.404690, 0.387663, 0.397717, 0.407004, 0.439634, 
  0.457856, 0.467534, 0.477282, 0.477431, 0.467844, 
  0.468787, 0.472387, 0.470625, 0.484103, 0.474205, 
  0.472357, 0.480481, 0.474943, 0.469339, 0.471955, 
  0.467177, 0.467908, 0.470483, 0.465587, 0.471878, 
  0.470672, 0.446815, 0.406719, 0.407145, 0.419924, 
  0.393659, 0.416965, 0.412576, 0.409112, 0.406581, 
  0.409821, 0.411127, 0.410485, 0.405938, 0.409156, 
  0.409444, 0.406788, 0.415868, 0.407299, 0.410488, 
  0.410721, 0.418833, 0.411153, 0.411352, 0.443229, 
  0.465255, 0.478383, 0.478605, 0.480800, 0.492937, 
  0.477182, 0.474346, 0.480469, 0.470612, 0.477705, 
  0.487786, 0.485864, 0.481925, 0.483966, 0.476992, 
  0.477000, 0.476992, 0.481967, 0.472928, 0.485864, 
  0.474798, 0.477705, 0.486582, 0.470493, 0.440451, 
  0.418406, 0.422263, 0.416156, 0.398126, 0.413867, 
  0.408742, 0.411540, 0.400473, 0.408190, 0.398121, 
  0.391025, 0.394756, 0.415152, 0.402149, 0.397984, 
  0.398705, 0.403309, 0.406911, 0.396901, 0.406286, 
  0.389536, 0.411399, 0.422569, 0.442299, 0.468606, 
  0.471864, 0.470330, 0.481114, 0.476687, 0.476980, 
  0.478190, 0.485928, 0.485192, 0.468622, 0.471616, 
  0.477340, 0.479319, 0.478509, 0.472202, 0.473201, 
  0.465107, 0.469692, 0.471520, 0.443777, 0.424272, 
  0.420001, 0.402506, 0.409762, 0.412560, 0.411831, 
  0.413688, 0.412923, 0.414719, 0.413917, 0.413105, 
  0.412280, 0.416477, 0.418103, 0.414714, 0.413815, 
  0.415362, 0.410355, 0.413477, 0.434222, 0.461062, 
  0.463718, 0.469459, 0.474304, 0.480601, 0.475968, 
  0.483621, 0.479716, 0.475828, 0.483193, 0.481485, 
  0.477548, 0.483137, 0.486415, 0.480241, 0.479828, 
  0.488567, 6.001344, 5.950168, 5.898559, 5.846521, 
  5.796759, 5.741172, 5.687870, 5.634155, 0.576034, 
  0.673741, 0.625565, 0.623601, 0.618456, 0.621931, 
  0.618517, 0.614460, 0.610377, 0.605679, 0.607938, 
  0.603704, 0.598879, 0.600753, 0.595818, 0.596864, 
  0.597738, 0.593140, 0.588517, 0.584384, 0.582749, 
  0.577500, 0.577659, 0.572793, 0.567904, 0.568157, 
  0.568216, 0.563088, 0.558829, 0.557585, 0.556609, 
  0.553761, 0.548309, 0.546902, 0.545314, 0.539638, 
  0.537384, 0.535339, 0.532745, 0.529267, 0.526356, 
  0.520541, 0.517695, 0.514339, 0.510498, 0.507741, 
  0.506572, 0.502452, 0.497881, 0.493984, 0.490153, 
  0.486620, 0.480079, 0.472021, 0.463530, 0.454208, 
  0.445242, 0.436190, 0.430469, 0.423280, 0.418811, 
  0.412858, 0.406756, 0.402383, 0.396028, 0.391318, 
  0.385564, 0.378776, 0.372694, 0.366170, 0.359229, 
  0.352160, 0.344519, 0.336244, 0.328993, 0.320308, 
  0.311766, 0.302820, 0.293548, 0.283786, 0.273603, 
  0.263000
};

double test8y[361] = { 
  -3.888000,-3.660861,-1.869715,-1.774392,-1.774918,
  -1.773311,-2.185001,-1.635943,-1.526273,-1.532262,
  -1.537128,-1.535896,-1.534547,-1.607599,-2.203452,
  -2.193076,-2.190473,-2.197593,-2.195631,-2.244786,
  -3.697953,-3.700971,-1.606924,-1.592378,-1.580687,
  -1.571837,-1.568736,-1.385627,-1.228394,-1.201471,
  -1.203544,-1.200684,-1.207345,-1.210031,-3.100340,
  -3.123423,-3.112808,-3.146538,-4.043037,-4.112745,
  -0.800618,-0.783058,-0.754333,-0.734099,-0.734330,
  -0.734484,-0.732722,-0.729980,-0.728096,-0.727969,
  -0.727765,-3.201470,-3.127803,-3.070520,-2.992000,
  -2.536851,-2.945513,-2.933492,-2.434067,-2.448311,
  -2.280245,-2.255745,-2.203777,-2.163148,-2.249024,
  -2.583308,-2.901800,-2.968634,-2.310528,-2.211955,
  -2.217445,-2.288479,-3.821796,-0.378617,-0.375359,
  -0.371289,-0.358545,-6.407213,-6.365603,-6.320377,
  -6.274670,-6.228485,-6.178807,-6.134696,-6.084127,
  -0.230768,-0.225988,-0.227042,-0.225873,-0.216828,
  -0.214960,-0.213076,-0.213260,-0.209260,-0.203236,
  -0.201326,-0.194717,-0.188847,-0.186977,-0.183144,
  -0.181909,-0.173649,-0.156701,-0.133841,-0.114513,
  -0.120535,-0.104114,-0.102904,-0.107565,-0.095816,
  -0.096934,-0.093457,-0.091148,-0.088862,-0.089865,
  -0.090266,-0.077898,-0.082555,-0.086526,-0.104045,
  -0.112500,-0.115720,-0.118778,-0.116427,-0.108917,
  -0.107126,-0.106688,-0.103518,-0.107839,-0.100740,
  -0.097625,-0.099112,-0.094363,-0.089719,-0.088696,
  -0.084573,-0.082788,-0.081730,-0.077766,-0.078096,
  -0.075586,-0.065092,-0.049486,-0.048230,-0.050988,
  -0.041197,-0.047072,-0.044306,-0.041897,-0.039819,
  -0.039340,-0.038308,-0.036772,-0.034316,-0.033743,
  -0.032466,-0.030563,-0.031101,-0.028049,-0.027335,
  -0.026047,-0.026078,-0.023465,-0.022171,-0.025330,
  -0.026627,-0.026446,-0.024565,-0.022892,-0.022140,
  -0.018738,-0.016633,-0.015207,-0.012698,-0.011252,
  -0.009814,-0.007783,-0.005733,-0.003857,-0.001867,
  -0.000000,0.001867,0.003822,0.005497,0.007783,
  0.009247,0.011252,0.013675,0.014509,0.013966,
  0.013596,0.015335,0.016097,0.015396,0.018524,
  0.019187,0.020876,0.020546,0.022996,0.022612,
  0.022574,0.024420,0.029575,0.028310,0.028692,
  0.030085,0.032393,0.034550,0.033385,0.037056,
  0.033905,0.041155,0.045756,0.053111,0.062860,
  0.065855,0.067366,0.072980,0.073578,0.075774,
  0.078323,0.083349,0.085292,0.080997,0.084286,
  0.088783,0.091822,0.093706,0.093143,0.095794,
  0.094244,0.098587,0.101702,0.090132,0.082172,
  0.081730,0.074177,0.079686,0.082902,0.084204,
  0.087000,0.088312,0.091162,0.092482,0.093796,
  0.095102,0.099669,0.102660,0.102332,0.103652,
  0.106685,0.105107,0.109328,0.126697,0.149250,
  0.154017,0.161303,0.168079,0.176210,0.175558,
  0.185123,0.185093,0.185009,0.194810,0.196724,
  0.196597,0.205282,0.212013,0.209787,0.213076,
  0.225567,5.839381,5.889235,5.938640,5.987593,
  6.039039,6.084127,6.131700,6.178807,0.366516,
  0.489502,0.439826,0.445305,0.446869,0.459410,
  0.463318,0.466403,0.469452,0.471657,0.483585,
  0.486576,0.488707,0.500739,0.502833,0.514105,
  0.525433,0.528334,0.531195,0.534872,0.542826,
  0.544730,0.556157,0.558882,0.561564,0.573916,
  0.586314,0.588955,0.593341,0.603990,0.615563,
  0.623540,0.626053,0.637655,0.649279,0.651717,
  0.662422,0.674063,0.684787,0.693650,0.704377,
  0.707589,0.719235,0.729940,0.739692,0.753237,
  0.772511,0.783214,0.792944,0.805537,0.819086,
  0.834560,0.839384,0.838336,0.835266,0.828215,
  0.822041,0.814797,0.823137,0.824567,0.840683,
  0.849889,0.859055,0.880030,0.890114,0.913027,
  0.930967,0.942919,0.962771,0.981593,0.999378,
  1.019107,1.035797,1.047442,1.078984,1.093499,
  1.116936,1.140305,1.166600,1.190819,1.214954,
  1.249000
};

result_t results8[] = {
  {DROS_CORNER_JUMP, 0.444, 0.836, 0.5},
  {0, 0.0, 0.0, 0.0}
};


double test9x[361] = {
  1.0800, 1.0800, 1.0798, 1.0796, 1.0793,
  1.0790, 1.0895, 1.0830, 1.0744, 1.0886,
  1.1855, 1.1815, 1.1755, 1.2261, 1.2585,
  4.7917, 4.7959, 4.8294, 5.5419, 5.5538,
  5.5533, 5.5554, 5.5648, 5.5660, 5.5686,
  5.4995, 5.3308, 5.1837, 5.0329, 4.8833,
  4.7495, 4.6100, 4.4920, 4.3732, 4.2584,
  4.1582, 4.0620, 3.9555, 3.8672, 3.7659,
  3.6949, 3.5996, 3.5252, 3.4509, 3.3787,
  3.3029, 3.2899, 3.3033, 3.2988, 3.3022,
  3.3053, 3.3080, 3.3121, 3.3139, 3.3172,
  3.3201, 3.3225, 3.3228, 3.3218, 2.9862,
  2.0395, 2.0438, 2.0486, 2.0540, 2.0506,
  2.0553, 2.0514, 2.0564, 2.0593, 2.0554,
  2.0602, 2.0654, 1.7208, 1.2757, 1.2099,
  1.1900, 1.1828, 1.1637, 1.1346, 1.1327,
  1.1406, 1.1414, 1.1479, 1.1452, 1.1437,
  1.1487, 1.1482, 1.1548, 1.1488, 1.1469,
  1.1483, 1.1544, 1.1566, 1.1592, 1.1608,
  1.1627, 1.1636, 1.1675, 3.4141, 3.3557,
  3.3046, 3.2478, 3.1963, 3.1456, 3.1122,
  3.0816, 3.0386, 3.1978, 3.2058, 3.2119,
  3.2224, 3.2308, 3.2372, 3.2448, 3.2526,
  3.2619, 3.2617, 3.2724, 3.2782, 3.2828,
  2.3460, 2.3026, 2.2578, 2.2188, 3.3314,
  3.3468, 3.3613, 3.6512, 3.5872, 3.5229,
  3.4583, 3.3934, 3.3283, 3.2630, 3.1974,
  3.1315, 3.0654, 2.9991, 2.9325, 1.5413,
  1.4970, 1.4370, 1.3993, 1.3619, 1.3232,
  1.2837, 1.2440, 1.2056, 1.1687, 1.1310,
  1.0933, 1.0559, 1.0185, 0.9807, 0.9452,
  0.9062, 0.8697, 0.8348, 0.7978, 0.7614,
  0.7246, 0.6878, 0.6392, 0.5992, 0.5641,
  0.5290, 0.4939, 0.4589, 0.4237, 0.3886,
  0.3533, 0.3181, 0.2816, 0.2465, 0.2113,
  0.1760, 0.1412, 0.1059, 0.0706, 0.0354,
  0.0000, -0.0354, -0.0710, -0.1064, -0.1423,
  -0.1777, -0.2143, -0.2505, -0.2869, -0.3293,
  -0.3587, -0.3778, -0.3875, -0.3996, -0.4114,
  -0.3873, -0.4108, -0.4312, -0.4421, -0.4514,
  -0.4576, -0.4625, -0.4688, -0.4703, -0.4761,
  -0.4833, -0.4888, -0.4916, -0.4971, -0.5015,
  -0.5060, -0.5200, -0.5336, -0.5499, -0.5631,
  -0.5762, -0.5924, -0.6048, -0.6173, -0.6332,
  -0.6450, -0.6570, -0.6687, -0.6839, -0.6953,
  -0.7103, -0.7213, -0.7361, -0.7455, -0.7539,
  -0.7704, -0.7818, -0.7996, -0.8116, -0.8254,
  -0.8348, -0.8493, -0.8632, -0.8717, -0.8849,
  -0.8990, -0.9070, -0.9204, -0.9337, -0.9422,
  -0.9553, -0.9684, -0.9758, -0.9875, -1.0014,
  -1.0141, -1.0261, -1.0386, -1.0511, -1.0580,
  -1.0745, -1.0922, -1.1168, -1.1353, -1.1589,
  -1.1782, -1.2028, -1.2281, -1.2471, -1.2727,
  -1.2985, -1.3244, -1.3499, -1.3761, -1.4025,
  -1.4291, -1.4557, -1.4818, -1.5073, -1.5336,
  -1.5675, -1.6000, -1.6267, -1.6611, -1.6881,
  -1.7205, -1.7547, -1.7882, -1.8297, -1.8636,
  -1.8993, -1.9407, -1.9767, -2.0201, -2.0638,
  -2.1003, -2.1468, -2.1994, -2.2281, -2.2787,
  -2.3370, -2.3644, -3.0456, -3.0627, -3.0769,
  -3.0978, -3.1037, -3.1101, -3.1330, -3.1442,
  -3.1595, -3.2575, -3.2074, -3.2276, -3.2439,
  -3.3271, -3.4105, -3.5135, -3.6160, -3.7244,
  -3.8323, -3.9257, -5.9258, -6.0039, -6.1230,
  -4.7746, -4.7811, -4.8136, -4.9882, -5.1785,
  -5.3866, -5.6030, -5.8315, -6.0886, -6.3677,
  -6.6765, -7.0123, -7.3578, -7.5660, -7.6469,
  -7.1240, -7.4056, -7.3298, -7.2739, -7.2397,
  -7.3762, -7.4011, -7.3701, -7.6461, -7.3438,
  -7.7511, -7.7786, -7.7777, -7.7851, -7.7860,
  -7.8590, -8.1578, -8.1631, -8.1677, -8.1718,
  -8.1752, -8.1780, -8.1802, -8.1818, -8.1827,
  -8.1830
};

double test9y[361] = {
  0.0000, 0.0094, 0.0188, 0.0283, 0.0377,
  0.0471, 0.0571, 0.0662, 0.0751, 0.0857,
  0.1037, 0.1138, 0.1236, 0.1397, 0.1545,
  0.6308, 0.6740, 0.7218, 0.8778, 0.9294,
  0.9792, 1.0296, 1.0817, 1.1324, 1.1836,
  1.2192, 1.2307, 1.2445, 1.2548, 1.2629,
  1.2726, 1.2785, 1.2881, 1.2954, 1.3019,
  1.3111, 1.3198, 1.3235, 1.3316, 1.3336,
  1.3448, 1.3458, 1.3532, 1.3594, 1.3651,
  1.3681, 1.3965, 1.4363, 1.4687, 1.5049,
  1.5413, 1.5778, 1.6154, 1.6523, 1.6902,
  1.7283, 1.7666, 1.8041, 1.8413, 1.6895,
  1.1775, 1.2039, 1.2309, 1.2587, 1.2813,
  1.3094, 1.3322, 1.3611, 1.3890, 1.4126,
  1.4425, 1.4732, 1.2502, 0.9440, 0.9117,
  0.9131, 0.9241, 0.9257, 0.9188, 0.9338,
  0.9571, 0.9748, 0.9979, 1.0131, 1.0298,
  1.0526, 1.0707, 1.0959, 1.1094, 1.1271,
  1.1483, 1.1747, 1.1977, 1.2215, 1.2448,
  1.2689, 1.2923, 1.3197, 3.9275, 3.9290,
  3.9382, 3.9399, 3.9471, 3.9545, 3.9834,
  4.0160, 4.0323, 4.3215, 4.4124, 4.5029,
  4.6020, 4.7008, 4.7993, 4.9024, 5.0085,
  5.1202, 5.2197, 5.3401, 5.4559, 5.5730,
  4.0634, 4.0698, 4.0731, 4.0865, 6.2654,
  6.4291, 6.5970, 7.3232, 7.3548, 7.3859,
  7.4163, 7.4462, 7.4755, 7.5043, 7.5325,
  7.5601, 7.5871, 7.6136, 7.6395, 4.1223,
  4.1130, 4.0581, 4.0638, 4.0702, 4.0724,
  4.0714, 4.0691, 4.0702, 4.0757, 4.0781,
  4.0801, 4.0827, 4.0849, 4.0849, 4.0943,
  4.0878, 4.0916, 4.1029, 4.1042, 4.1080,
  4.1096, 4.1099, 4.0357, 4.0095, 4.0136,
  4.0183, 4.0228, 4.0279, 4.0308, 4.0353,
  4.0386, 4.0415, 4.0272, 4.0295, 4.0315,
  4.0312, 4.0435, 4.0446, 4.0444, 4.0548,
  4.0470, 4.0558, 4.0654, 4.0646, 4.0735,
  4.0711, 4.0884, 4.0953, 4.1030, 4.1841,
  4.1003, 3.9239, 3.6867, 3.5073, 3.3508,
  2.9416, 2.9233, 2.8850, 2.7912, 2.6975,
  2.5950, 2.4955, 2.4119, 2.3116, 2.2400,
  2.1801, 2.1173, 2.0478, 1.9940, 1.9392,
  1.8884, 1.8752, 1.8610, 1.8563, 1.8418,
  1.8273, 1.8232, 1.8075, 1.7927, 1.7882,
  1.7723, 1.7572, 1.7421, 1.7362, 1.7209,
  1.7147, 1.6993, 1.6929, 1.6745, 1.6543,
  1.6522, 1.6391, 1.6394, 1.6279, 1.6198,
  1.6037, 1.5973, 1.5898, 1.5726, 1.5640,
  1.5571, 1.5397, 1.5318, 1.5237, 1.5078,
  1.4995, 1.4912, 1.4743, 1.4641, 1.4571,
  1.4483, 1.4385, 1.4295, 1.4204, 1.4040,
  1.4003, 1.3979, 1.4040, 1.4020, 1.4059,
  1.4042, 1.4083, 1.4128, 1.4095, 1.4135,
  1.4170, 1.4203, 1.4225, 1.4250, 1.4272,
  1.4291, 1.4306, 1.4310, 1.4304, 1.4302,
  1.4363, 1.4406, 1.4392, 1.4440, 1.4418,
  1.4437, 1.4464, 1.4481, 1.4554, 1.4560,
  1.4574, 1.4624, 1.4627, 1.4677, 1.4721,
  1.4706, 1.4755, 1.4835, 1.4748, 1.4798,
  1.4889, 1.4774, 1.8664, 1.8402, 1.8124,
  1.7885, 1.7560, 1.7240, 1.7011, 1.6718,
  1.6447, 1.6598, 1.5992, 1.5742, 1.5473,
  1.5514, 1.5543, 1.5643, 1.5723, 1.5809,
  1.5874, 1.5861, 2.3342, 2.3047, 2.2893,
  1.7378, 1.6931, 1.6575, 1.6690, 1.6826,
  1.6984, 1.7130, 1.7274, 1.7459, 1.7659,
  1.7890, 1.8135, 1.8345, 1.8164, 1.7654,
  1.5794, 1.5741, 1.4913, 1.4139, 1.3418,
  1.3006, 1.2385, 1.1673, 1.1427, 1.0321,
  1.0205, 0.9551, 0.8862, 0.8182, 0.7497,
  0.6876, 0.6420, 0.5708, 0.4996, 0.4283,
  0.3569, 0.2856, 0.2142, 0.1428, 0.0714,
  0.0000
};

result_t results9[] = {
  {DROS_CORNER_JUMP, 0.561, 4.070, 0.5},
  {DROS_CORNER_CONVEX, -0.506, 1.889, 0.1},
  {0, 0.0, 0.0, 0.0}
};


double test10x[361] = { 
  1.1680, 1.1750, 1.1938, 1.2026, 1.2103,
  1.2288, 1.2373, 1.2467, 1.2629, 1.2711,
  1.2881, 1.2950, 1.3078, 1.3195, 1.3241,
  1.3156, 1.3121, 1.3006, 1.2899, 1.2802,
  1.2734, 1.2615, 1.2506, 1.2484, 1.2374,
  1.2360, 1.2238, 1.2125, 1.2100, 1.1995,
  1.1968, 1.1853, 1.1727, 1.1611, 1.1590,
  1.1559, 1.1432, 1.1276, 1.1176, 1.1425,
  1.1615, 1.1577, 1.2529, 1.2347, 1.1460,
  1.1438, 1.1368, 1.1381, 1.1328, 1.1402,
  1.1320, 1.1382, 1.1343, 1.1285, 1.1209,
  1.1238, 1.1258, 1.1337, 1.1283, 1.1297,
  1.1267, 1.1193, 1.1220, 1.1221, 1.1160,
  1.1175, 1.1179, 1.1191, 1.1200, 1.1126,
  1.1124, 1.1113, 1.1116, 1.1125, 1.1125,
  1.1075, 1.1032, 1.0980, 1.0973, 1.0949,
  1.0962, 1.0935, 1.0921, 1.0890, 1.0828,
  1.0831, 1.0802, 1.0801, 1.0761, 1.0756,
  1.0748, 1.0703, 1.0677, 1.0663, 1.0660,
  1.0573, 1.0452, 1.0443, 1.0477, 1.0430,
  1.0439, 1.0387, 1.0377, 3.5539, 3.5271,
  3.4919, 3.4580, 3.4238, 2.5498, 2.3867,
  3.3181, 3.2880, 2.1736, 2.1592, 3.1774,
  3.1448, 3.1059, 2.9934, 2.5989, 0.5969,
  0.5930, 0.5820, 0.5585, 0.5430, 0.5357,
  0.5315, 0.5225, 0.5176, 0.5085, 0.5037,
  0.4945, 0.4881, 0.4783, 0.4729, 0.4630,
  0.4539, 0.4473, 0.4416, 0.4318, 0.4252,
  0.4183, 0.4082, 0.4014, 0.3941, 0.3841,
  0.3729, 0.3497, 0.3343, 0.3178, 0.3030,
  0.2914, 0.2769, 0.2632, 0.2517, 0.2402,
  0.2273, 0.2139, 0.2032, 0.1929, 0.1806,
  0.1707, 0.1598, 0.1589, 0.1938, 0.1850,
  0.1745, 0.1642, 0.1545, 0.1436, 0.1327,
  0.1214, 0.1099, 0.0983, 0.0871, 0.0751,
  0.0635, 0.0511, 0.0386, 0.0260, 0.0131,
  0.0000, -0.0133, -0.0268, -0.0408, -0.0550,
  -0.0692, -0.0840, -0.0993, -0.1141, -0.1298,
  -0.1459, -0.1624, -0.1791, -0.1961, -0.2135,
  -0.2325, -0.2515, -0.2669, -0.2802, -0.2943,
  -0.3075, -0.3215, -0.3343, -0.3459, -0.3586,
  -0.3714, -0.3838, -0.3978, -0.4098, -0.4219,
  -0.4333, -0.4479, -0.6508, -0.6865, -0.7172,
  -1.2073, -1.2379, -1.2651, -1.2922, -1.3182,
  -1.3472, -1.3756, -1.4009, -1.4286, -1.4531,
  -1.4802, -1.5082, -1.5304, -1.5578, -1.5841,
  -1.6102, -1.6364, -1.6619, -1.6840, -1.7656,
  -1.8525, -1.9446, -2.0422, -2.1443, -2.2568,
  -2.3755, -2.5077, -2.6494, -2.8079, -2.9681,
  -3.1411, -3.3555, -3.5699, -3.8517, -4.5556,
  -4.6391, -4.7397, -4.8098, -4.8615, -4.9132,
  -4.9699, -5.0213, -5.0710, -5.1195, -5.2050,
  -5.2599, -5.3144, -5.3685, -5.4222, -5.4434,
  -5.4939, -5.5808, -5.6328, -5.6844, -5.7355,
  -5.7863, -5.7902, -5.8454, -5.9009, -5.9503,
  -4.6861, -4.6692, -4.6742, -4.6264, -4.2484,
  -3.9742, -3.7393, -3.5290, -3.3425, -3.1583,
  -3.0179, -2.8927, -2.7645, -2.6584, -2.5588,
  -2.4673, -2.3801, -2.3147, -2.2398, -2.1805,
  -2.1119, -2.0565, -1.9960, -1.9346, -1.8887,
  -1.8507, -1.8103, -1.7641, -1.7295, -1.6961,
  -1.6605, -1.6243, -1.5885, -1.5612, -1.5272,
  -1.4999, -1.4796, -1.4589, -1.4297, -1.4084,
  -1.3877, -1.3648, -1.3538, -1.3313, -1.3132,
  -1.2921, -1.2716, -1.2585, -1.2376, -1.2288,
  -1.2150, -1.2002, -1.1880, -1.1737, -1.1506,
  -1.1446, -1.1318, -1.1168, -1.1007, -1.0854,
  -1.0798, -1.0632, -1.0554, -1.0376, -1.0305,
  -1.0203, -1.0021, -0.9946, -0.9870, -0.9784,
  -0.9706, -0.9618, -0.9528, -0.9468, -0.9387,
  -0.9294, -0.9202, -0.9098, -0.9003, -0.9018,
  -0.8822, -0.8755, -0.8707, -0.8899, -0.8930,
  -0.9030
};

double test10y[361] = { 
  0.0000,   0.0103,   0.0208,   0.0315,   0.0423,
  0.0537,   0.0648,   0.0762,   0.0883,   0.1000,
  0.1127,   0.1247,   0.1375,   0.1503,   0.1626,
  0.1732,   0.1844,   0.1944,   0.2043,   0.2142,
  0.2245,   0.2338,   0.2431,   0.2540,   0.2630,
  0.2740,   0.2825,   0.2911,   0.3017,   0.3102,
  0.3207,   0.3287,   0.3363,   0.3439,   0.3544,
  0.3645,   0.3714,   0.3773,   0.3848,   0.4046,
  0.4227,   0.4329,   0.4809,   0.4863,   0.4630,
  0.4738,   0.4826,   0.4948,   0.5044,   0.5196,
  0.5279,   0.5429,   0.5532,   0.5627,   0.5711,
  0.5850,   0.5986,   0.6155,   0.6254,   0.6392,
  0.6505,   0.6593,   0.6742,   0.6876,   0.6974,
  0.7119,   0.7260,   0.7407,   0.7555,   0.7646,
  0.7789,   0.7927,   0.8076,   0.8232,   0.8383,
  0.8498,   0.8619,   0.8734,   0.8886,   0.9026,
  0.9198,   0.9339,   0.9493,   0.9634,   0.9749,
  0.9924,   1.0073,   1.0250,   1.0392,   1.0570,
  1.0748,   1.0891,   1.1056,   1.1236,   1.1431,
  1.1538,   1.1608,   1.1804,   1.2053,   1.2212,
  1.2441,   1.2601,   1.2815,   4.4679,   4.5145,
  4.5507,   4.5890,   4.6270,   3.5095,   3.3460,
  4.7388,   4.7841,   3.2225,   3.2622,   4.8928,
  4.9364,   4.9704,   4.8848,   4.3253,   1.0133,
  1.0271,   1.0288,   1.0076,   1.0001,   1.0074,
  1.0209,   1.0255,   1.0381,   1.0426,   1.0560,
  1.0604,   1.0710,   1.0743,   1.0876,   1.0908,
  1.0957,   1.1071,   1.1212,   1.1250,   1.1371,
  1.1492,   1.1529,   1.1658,   1.1778,   1.1822,
  1.1826,   1.1437,   1.1285,   1.1083,   1.0928,
  1.0876,   1.0708,   1.0557,   1.0482,   1.0406,
  1.0251,   1.0065,   0.9985,   0.9924,   0.9744,
  0.9681,   0.9547,   1.0035,   1.2966,   1.3161,
  1.3256,   1.3370,   1.3562,   1.3665,   1.3776,
  1.3877,   1.3967,   1.4056,   1.4243,   1.4330,
  1.4536,   1.4631,   1.4735,   1.4898,   1.4989,
  1.5190,   1.5289,   1.5378,   1.5565,   1.5750,
  1.5845,   1.6028,   1.6230,   1.6320,   1.6499,
  1.6676,   1.6862,   1.7036,   1.7209,   1.7389,
  1.7658,   1.7894,   1.7862,   1.7689,   1.7585,
  1.7441,   1.7345,   1.7198,   1.7002,   1.6873,
  1.6753,   1.6623,   1.6569,   1.6437,   1.6313,
  1.6170,   1.6150,   2.2695,   2.3175,   2.3458,
  3.8292,   3.8099,   3.7810,   3.7528,   3.7225,
  3.7014,   3.6792,   3.6494,   3.6268,   3.5965,
  3.5736,   3.5531,   3.5197,   3.4989,   3.4761,
  3.4530,   3.4307,   3.4073,   3.3775,   3.4651,
  3.5587,   3.6572,   3.7613,   3.8684,   3.9888,
  4.1145,   4.2573,   4.4093,   4.5821,   4.7499,
  4.9305,   5.1670,   5.3936,   5.7104,   6.6284,
  6.6253,   6.6448,   6.6202,   6.5699,   6.5201,
  6.4769,   6.4270,   6.3751,   6.3221,   6.3142,
  6.2685,   6.2224,   6.1758,   6.1287,   6.0455,
  5.9955,   5.9847,   5.9357,   5.8864,   5.8365,
  5.7863,   5.6900,   5.6448,   5.5998,   5.5487,
  4.2941,   4.2041,   4.1354,   4.0216,   3.6285,
  3.3348,   3.0824,   2.8577,   2.6588,   2.4676,
  2.3157,   2.1798,   2.0456,   1.9315,   1.8251,
  1.7276,   1.6358,   1.5613,   1.4825,   1.4161,
  1.3454,   1.2851,   1.2232,   1.1624,   1.1125,
  1.0685,   1.0242,   0.9779,   0.9390,   0.9019,
  0.8644,   0.8276,   0.7920,   0.7615,   0.7284,
  0.6994,   0.6743,   0.6496,   0.6216,   0.5978,
  0.5748,   0.5514,   0.5333,   0.5110,   0.4910,
  0.4703,   0.4503,   0.4333,   0.4141,   0.3992,
  0.3831,   0.3669,   0.3519,   0.3366,   0.3191,
  0.3067,   0.2927,   0.2785,   0.2643,   0.2506,
  0.2394,   0.2260,   0.2147,   0.2017,   0.1910,
  0.1799,   0.1677,   0.1575,   0.1475,   0.1375,
  0.1278,   0.1181,   0.1086,   0.0995,   0.0904,
  0.0813,   0.0724,   0.0636,   0.0551,   0.0473,
  0.0385,   0.0306,   0.0228,   0.0155,   0.0078,
  0.0000
};

result_t results10[] = {
  {DROS_CORNER_CONVEX_HIDDEN, 1.036, 1.281, 0.2},
  {DROS_CORNER_CONVEX, -1.686, 3.380, 0.3},
  {0, 0.0, 0.0, 0.0}
};

double test11x[361] = { 
  1.4880, 1.4879, 1.4988, 1.5065, 1.5061,
  1.5166, 1.5259, 1.5341, 1.5412, 1.5382,
  1.5461, 1.5807, 1.6032, 1.5798, 1.5583,
  1.5387, 1.5111, 1.4875, 1.4667, 1.4469,
  1.4349, 1.4051, 1.3870, 1.3748, 1.3547,
  1.3356, 1.3242, 1.3049, 1.2837, 1.2731,
  1.2567, 1.2354, 1.2246, 1.2129, 1.2011,
  1.1807, 1.1698, 1.1579, 1.1365, 1.1236,
  1.1126, 1.0940, 1.0820, 1.0700, 1.0570,
  1.0468, 1.0337, 1.0207, 1.0086, 0.9982,
  0.9852, 0.9820, 0.9689, 0.9558, 0.9418,
  0.9252, 0.9139, 0.9219, 0.9385, 0.9461,
  0.9492, 0.9607, 0.9635, 0.9737, 0.9837,
  0.9918, 0.9930, 1.0015, 1.0114, 1.0219,
  1.0289, 1.0372, 1.0452, 1.0506, 1.0638,
  1.0790, 1.0859, 1.0988, 1.1121, 1.1250,
  1.1314, 1.1437, 1.1570, 1.1751, 1.1838,
  1.1981, 1.2140, 1.2317, 1.2560, 1.2724,
  1.2954, 1.3114, 1.3337, 1.3547, 1.3749,
  1.3998, 1.4293, 1.4525, 1.4860, 1.5178,
  1.5510, 1.5902, 1.6230, 1.6621, 1.6992,
  1.7557, 1.8054, 1.8636, 1.9262, 1.9901,
  2.0637, 2.1348, 2.2217, 2.3275, 2.4394,
  2.5667, 2.7047, 2.8717, 3.0727, 3.3305,
  3.6235, 3.9832, 3.9672, 3.9046, 3.8417,
  3.7785, 3.7150, 3.6512, 3.5872, 3.5229,
  3.4583, 3.3934, 3.3283, 3.2630, 3.1454,
  3.0645, 3.0017, 2.9404, 2.8773, 2.8150,
  2.7526, 2.6865, 2.6189, 2.5575, 1.9570,
  1.7994, 1.6420, 1.5036, 1.3801, 1.2702,
  1.1709, 1.0804, 1.0001, 0.9219, 0.8514,
  0.7874, 0.7291, 0.6727, 0.6209, 0.5735,
  0.5286, 0.4864, 0.4463, 0.4094, 0.3749,
  0.3418, 0.3110, 0.2813, 0.2527, 0.2264,
  0.2010, 0.1768, 0.1534, 0.1314, 0.1107,
  0.0899, 0.0705, 0.0519, 0.0339, 0.0166,
  0.0000, -0.0160, -0.0315, -0.0463, -0.0607,
  -0.0742, -0.0876, -0.1004, -0.1136, -0.1253,
  -0.1374, -0.1485, -0.1599, -0.1708, -0.1806,
  -0.1908, -0.2011, -0.2121, -0.2204, -0.2296,
  -0.2384, -0.2469, -0.2551, -0.2630, -0.2703,
  -0.2803, -0.2870, -0.2958, -0.3022, -0.3085,
  -0.3165, -0.3220, -0.3321, -0.3368, -0.3447,
  -0.3524, -0.3554, -0.3627, -0.3786, -0.3919,
  -0.4036, -0.4160, -0.4290, -0.4457, -0.4589,
  -0.4722, -0.4892, -0.5024, -0.5153, -0.5296,
  -0.5477, -0.5640, -0.5786, -0.5966, -0.6152,
  -0.6298, -0.6488, -0.6675, -0.6875, -0.7071,
  -0.7270, -0.7466, -0.7674, -0.7885, -0.8092,
  -0.8360, -0.8578, -0.8792, -0.9031, -0.9300,
  -0.9527, -0.9814, -1.0086, -1.0368, -1.0730,
  -1.0970, -1.1267, -1.1573, -1.1882, -1.2270,
  -1.2644, -1.3015, -1.3456, -1.3855, -1.4299,
  -1.4748, -1.5202, -1.5653, -1.6179, -1.6696,
  -1.7239, -1.7810, -1.8401, -1.9092, -1.9790,
  -2.0437, -2.1172, -2.1997, -2.2747, -2.3755,
  -2.4759, -2.5780, -2.6920, -2.7994, -2.9259,
  -3.0647, -3.3111, -4.1865, -4.2117, -4.2367,
  -4.3071, -4.3275, -4.4213, -4.4571, -4.4827,
  -4.5003, -4.5167, -4.5420, -4.5576, -4.5813,
  -4.5969, -4.6190, -4.6346, -4.6569, -4.7096,
  -5.0001, -5.0823, -5.2148, -5.2409, -5.2901,
  -7.4163, -7.4462, -7.4755, -7.5043, -7.5325,
  -7.5601, -7.5871, -7.6136, -5.6818, -5.5058,
  -5.1749, -5.0969, -5.0623, -5.0413, -5.0644,
  -5.0881, -5.1105, -5.1239, -5.1466, -5.1689,
  -5.1803, -5.2096, -5.2212, -5.2518, -3.4863,
  -3.4434, -3.4284, -3.4190, -3.4102, -3.4198,
  -3.3218, -3.2153, -3.1250, -3.0284, -2.9480,
  -2.8663, -2.7940, -2.7194, -2.6584, -2.5950,
  -2.5323, -2.4823, -2.4241, -2.3696, -2.3158,
  -2.2708, -2.2266, -2.1892, -2.1417, -2.1019,
  -2.0620
};

double test11y[361] = { 
  0.0000, 0.0130, 0.0262, 0.0394, 0.0526,
  0.0662, 0.0800, 0.0938, 0.1078, 0.1211,
  0.1353, 0.1522, 0.1685, 0.1800, 0.1913,
  0.2026, 0.2124, 0.2223, 0.2323, 0.2421,
  0.2530, 0.2604, 0.2696, 0.2797, 0.2880,
  0.2961, 0.3057, 0.3133, 0.3201, 0.3292,
  0.3367, 0.3426, 0.3512, 0.3593, 0.3672,
  0.3723, 0.3801, 0.3874, 0.3913, 0.3979,
  0.4050, 0.4090, 0.4153, 0.4215, 0.4271,
  0.4336, 0.4388, 0.4438, 0.4490, 0.4549,
  0.4594, 0.4684, 0.4726, 0.4765, 0.4799,
  0.4816, 0.4859, 0.5005, 0.5202, 0.5353,
  0.5480, 0.5659, 0.5789, 0.5967, 0.6147,
  0.6319, 0.6449, 0.6629, 0.6822, 0.7023,
  0.7204, 0.7398, 0.7594, 0.7774, 0.8016,
  0.8279, 0.8484, 0.8740, 0.9006, 0.9274,
  0.9494, 0.9768, 1.0057, 1.0397, 1.0659,
  1.0978, 1.1321, 1.1688, 1.2129, 1.2504,
  1.2954, 1.3345, 1.3811, 1.4275, 1.4744,
  1.5276, 1.5874, 1.6417, 1.7094, 1.7771,
  1.8485, 1.9291, 2.0043, 2.0896, 2.1749,
  2.2880, 2.3959, 2.5185, 2.6511, 2.7900,
  2.9473, 3.1061, 3.2938, 3.5165, 3.7564,
  4.0289, 4.3284, 4.6861, 5.1139, 5.6540,
  6.2761, 7.0403, 7.1570, 7.1914, 7.2252,
  7.2584, 7.2911, 7.3232, 7.3548, 7.3859,
  7.4163, 7.4462, 7.4755, 7.5043, 7.4101,
  7.3984, 7.4295, 7.4647, 7.4957, 7.5290,
  7.5626, 7.5864, 7.6058, 7.6435, 6.0230,
  5.7070, 5.3706, 5.0760, 4.8130, 4.5801,
  4.3698, 4.1776, 4.0112, 3.8399, 3.6880,
  3.5518, 3.4304, 3.3063, 3.1942, 3.0943,
  2.9978, 2.9066, 2.8179, 2.7396, 2.6678,
  2.5966, 2.5330, 2.4690, 2.4048, 2.3511,
  2.2972, 2.2471, 2.1936, 2.1480, 2.1131,
  2.0580, 2.0198, 1.9823, 1.9427, 1.9039,
  1.8630, 1.8319, 1.8047, 1.7674, 1.7379,
  1.6994, 1.6707, 1.6409, 1.6240, 1.5921,
  1.5700, 1.5419, 1.5216, 1.4993, 1.4710,
  1.4495, 1.4309, 1.4192, 1.3917, 1.3719,
  1.3521, 1.3323, 1.3124, 1.2925, 1.2716,
  1.2643, 1.2433, 1.2320, 1.2119, 1.1928,
  1.1813, 1.1612, 1.1583, 1.1372, 1.1275,
  1.1178, 1.0937, 1.0839, 1.0996, 1.1067,
  1.1088, 1.1128, 1.1175, 1.1314, 1.1358,
  1.1401, 1.1525, 1.1555, 1.1575, 1.1620,
  1.1746, 1.1824, 1.1864, 1.1965, 1.2073,
  1.2099, 1.2202, 1.2295, 1.2402, 1.2498,
  1.2592, 1.2675, 1.2772, 1.2866, 1.2950,
  1.3123, 1.3209, 1.3284, 1.3389, 1.3532,
  1.3606, 1.3759, 1.3883, 1.4011, 1.4240,
  1.4296, 1.4421, 1.4549, 1.4673, 1.4885,
  1.5068, 1.5239, 1.5479, 1.5661, 1.5881,
  1.6095, 1.6302, 1.6495, 1.6753, 1.6990,
  1.7239, 1.7502, 1.7769, 1.8117, 1.8455,
  1.8727, 1.9064, 1.9461, 1.9774, 2.0289,
  2.0775, 2.1251, 2.1800, 2.2267, 2.2860,
  2.3516, 2.4951, 3.0978, 3.0600, 3.0220,
  3.0159, 2.9742, 2.9822, 2.9501, 2.9111,
  2.8670, 2.8224, 2.7833, 2.7385, 2.6986,
  2.6540, 2.6133, 2.5690, 2.5285, 2.5042,
  2.6029, 2.5896, 2.6000, 2.5561, 2.5232,
  3.4583, 3.3934, 3.3283, 3.2630, 3.1974,
  3.1315, 3.0654, 2.9991, 2.1810, 2.0585,
  1.8835, 1.8049, 1.7431, 1.6868, 1.6455,
  1.6043, 1.5624, 1.5178, 1.4758, 1.4335,
  1.3880, 1.3473, 1.3018, 1.2608, 0.8049,
  0.7634, 0.7287, 0.6956, 0.6629, 0.6338,
  0.5857, 0.5381, 0.4950, 0.4526, 0.4143,
  0.3774, 0.3431, 0.3098, 0.2794, 0.2499,
  0.2215, 0.1954, 0.1695, 0.1449, 0.1214,
  0.0991, 0.0778, 0.0573, 0.0374, 0.0183,
  0.0000 
};

result_t results11[] = {
  {DROS_CORNER_CONVEX, 0.992, 0.491, 0.5},
  {DROS_CORNER_CONVEX, -0.361, 1.088, 0.5},
  {0, 0.0, 0.0, 0.0}
};

double test12x[361] = { 
  1.3300, 1.3479, 1.3548, 1.3685, 1.3752,
  1.3857, 1.3881, 1.4932, 2.1946, 2.2032,
  2.1837, 2.1819, 2.1720, 2.1700, 2.1608,
  2.1495, 2.1380, 2.1284, 2.1255, 2.1146,
  2.1045, 2.1012, 2.0899, 2.0804, 2.0766,
  2.0658, 2.0540, 2.0478, 2.0337, 2.0341,
  2.0130, 2.0188, 2.0052, 2.0011, 1.9901,
  2.0839, 2.0105, 1.9924, 1.9846, 1.9607,
  1.9546, 1.9979, 2.0184, 2.0534, 2.0723,
  2.0991, 2.1328, 2.1670, 2.1998, 2.2358,
  2.2776, 2.3106, 2.3459, 2.3841, 2.4164,
  2.6389, 2.6868, 2.7393, 2.7839, 2.8495,
  2.9029, 2.9347, 3.0129, 3.0004, 2.9733,
  3.0573, 3.1224, 3.2196, 3.3029, 3.4020,
  3.4994, 3.6139, 3.7288, 3.8521, 4.0004,
  4.1477, 4.3073, 4.5141, 4.6909, 4.9191,
  5.1585, 5.4346, 5.7660, 6.0943, 6.0812,
  6.0331, 5.9847, 5.9357, 5.8864, 5.8365,
  5.7863, 5.7355, 5.6844, 5.6328, 5.5808,
  5.5284, 5.4755, 5.4222, 5.3685, 5.3144,
  5.2599, 5.2050, 5.1497, 5.0940, 5.0380,
  4.9681, 4.8591, 4.7735, 4.7176, 4.6741,
  4.6741, 4.6349, 4.5759, 4.3261, 4.0064,
  3.7289, 3.6151, 3.5697, 3.5187, 3.4766,
  3.4295, 3.3834, 2.4221, 2.2913, 2.1746,
  2.0599, 0.9974, 0.9879, 0.9578, 0.9346,
  0.9112, 0.8891, 0.8688, 0.8493, 0.8291,
  0.8121, 0.7949, 0.7777, 0.7630, 0.7480,
  0.7336, 0.7204, 0.7104, 0.7003, 0.6984,
  0.6949, 0.6646, 0.6299, 0.6009, 0.5754,
  0.5456, 0.5208, 0.4942, 0.4704, 0.4472,
  0.4238, 0.4013, 0.3788, 0.3572, 0.3377,
  0.3167, 0.2968, 0.2756, 0.2581, 0.2434,
  0.2295, 0.2155, 0.2013, 0.1868, 0.1719,
  0.1569, 0.1419, 0.1280, 0.1128, 0.0971,
  0.0818, 0.0658, 0.0496, 0.0336, 0.0173,
  0.0000, -0.0171, -0.0345, -0.0522, -0.0699,
  -0.0886, -0.1069, -0.1258, -0.1445, -0.1639,
  -0.1839, -0.2040, -0.2254, -0.2541, -0.2751,
  -0.2933, -0.3134, -0.3332, -0.3567, -0.3808,
  -0.4053, -0.4304, -0.4557, -0.4817, -0.5081,
  -0.5353, -0.5628, -0.5911, -0.6217, -0.6505,
  -0.6815, -0.7135, -0.7459, -0.7768, -0.8105,
  -0.8453, -0.8844, -0.9525, -0.9816, -1.0084,
  -1.0404, -1.0846, -1.1296, -1.1750, -1.2208,
  -1.2682, -1.3156, -1.3697, -1.4220, -1.4776,
  -1.5404, -1.6110, -1.6798, -1.7330, -1.8028,
  -1.8724, -1.9497, -2.0303, -2.1138, -2.2011,
  -2.2840, -2.8310, -2.8677, -2.8988, -2.9352,
  -2.9611, -3.0091, -3.0964, -3.2428, -3.4007,
  -3.5676, -3.7508, -3.9570, -4.8621, -4.9216,
  -4.9845, -5.0373, -5.0990, -5.1497, -5.2050,
  -5.2599, -5.3144, -5.3685, -5.2831, -5.3256,
  -5.3790, -5.4226, -5.4676, -5.5177, -5.5610,
  -5.6095, -5.6525, -5.7008, -5.7421, -5.7894,
  -5.8363, -5.8820, -5.9280, -5.9735, -6.0186,
  -6.0632, -6.1074, -3.1622, -2.6084, -2.2356,
  -1.9390, -1.7251, -1.5410, -1.3980, -1.2871,
  -1.1870, -1.1027, -1.0346, -0.9823, -0.9284,
  -0.8805, -0.8413, -0.8015, -0.7637, -0.7307,
  -0.7023, -0.6806, -0.6542, -0.6521, -0.6551,
  -0.6493, -0.6531, -0.6515, -0.6588, -0.6706,
  -0.6743, -0.6770, -0.6797, -0.6814, -0.6839,
  -0.6948, -0.7000, -0.6997, -0.7021, -0.7137,
  -0.7170, -0.7183, -0.7214, -0.7293, -0.7428,
  -0.7439, -0.7469, -0.7479, -0.7613, -0.7642,
  -0.7660, -0.7765, -0.7791, -0.7808, -0.7912,
  -0.7928, -0.7952, -0.7986, -0.8010, -0.8082,
  -0.8164, -0.8265, -0.8297, -0.8387, -0.8407,
  -0.8507, -0.8506, -0.8535, -0.8642, -0.8740,
  -0.8846, -0.8853, -0.8958, -0.8953, -0.9078,
  -0.9071, -0.9184, -0.9137, -0.9299, -0.9400,
  -0.9390
};

double test12y[361] = { 
  0.0000, 0.0118, 0.0236, 0.0358, 0.0480,
  0.0605, 0.0727, 0.0913, 0.1535, 0.1734,
  0.1910, 0.2101, 0.2283, 0.2472, 0.2653,
  0.2830, 0.3005, 0.3181, 0.3366, 0.3539,
  0.3711, 0.3894, 0.4062, 0.4233, 0.4414,
  0.4580, 0.4742, 0.4916, 0.5071, 0.5260,
  0.5394, 0.5599, 0.5750, 0.5927, 0.6084,
  0.6570, 0.6533, 0.6667, 0.6834, 0.6943,
  0.7114, 0.7470, 0.7748, 0.8089, 0.8372,
  0.8695, 0.9053, 0.9422, 0.9794, 1.0189,
  1.0620, 1.1021, 1.1441, 1.1887, 1.2312,
  1.3737, 1.4286, 1.4873, 1.5431, 1.6122,
  1.6760, 1.7287, 1.8104, 1.8387, 1.8579,
  1.9477, 2.0277, 2.1310, 2.2278, 2.3381,
  2.4503, 2.5777, 2.7091, 2.8504, 3.0145,
  3.1826, 3.3652, 3.5907, 3.7986, 4.0550,
  4.3285, 4.6416, 5.0123, 5.3917, 5.4755,
  5.5284, 5.5808, 5.6328, 5.6844, 5.7355,
  5.7863, 5.8365, 5.8864, 5.9357, 5.9847,
  6.0331, 6.0812, 6.1287, 6.1758, 6.2224,
  6.2685, 6.3142, 6.3594, 6.4041, 6.4483,
  6.4746, 6.4482, 6.4510, 6.4932, 6.5528,
  6.6753, 6.7438, 6.7840, 6.5360, 6.1693,
  5.8531, 5.7854, 5.8252, 5.8562, 5.9022,
  5.9401, 5.9802, 4.3696, 4.2201, 4.0898,
  3.9570, 1.9575, 1.9814, 1.9639, 1.9595,
  1.9540, 1.9510, 1.9513, 1.9533, 1.9533,
  1.9605, 1.9675, 1.9743, 1.9876, 2.0007,
  2.0156, 2.0342, 2.0631, 2.0930, 2.1494,
  2.2040, 2.1737, 2.1267, 2.0956, 2.0747,
  2.0362, 2.0137, 1.9823, 1.9593, 1.9370,
  1.9116, 1.8878, 1.8619, 1.8376, 1.8220,
  1.7963, 1.7733, 1.7403, 1.7268, 1.7320,
  1.7430, 1.7548, 1.7666, 1.7772, 1.7847,
  1.7932, 1.8034, 1.8305, 1.8436, 1.8525,
  1.8732, 1.8839, 1.8944, 1.9257, 1.9799,
  1.9680, 1.9549, 1.9737, 1.9923, 2.0008,
  2.0301, 2.0392, 2.0562, 2.0660, 2.0826,
  2.1020, 2.1182, 2.1442, 2.2306, 2.2402,
  2.2278, 2.2301, 2.2292, 2.2519, 2.2754,
  2.2985, 2.3224, 2.3441, 2.3675, 2.3906,
  2.4144, 2.4379, 2.4620, 2.4937, 2.5152,
  2.5433, 2.5729, 2.6012, 2.6224, 2.6509,
  2.6809, 2.7219, 2.8469, 2.8507, 2.8477,
  2.8585, 2.9009, 2.9426, 2.9829, 3.0217,
  3.0617, 3.0993, 3.1501, 3.1938, 3.2422,
  3.3035, 3.3775, 3.4442, 3.4759, 3.5382,
  3.5968, 3.6669, 3.7394, 3.8133, 3.8905,
  3.9560, 4.8062, 4.7727, 4.7304, 4.6973,
  4.6479, 4.6337, 4.6781, 4.8076, 4.9481,
  5.0951, 5.2584, 5.4463, 6.5707, 6.5312,
  6.4960, 6.4475, 6.4103, 6.3594, 6.3142,
  6.2685, 6.2224, 6.1758, 5.9714, 5.9147,
  5.8702, 5.8150, 5.7616, 5.7137, 5.6589,
  5.6095, 5.5547, 5.5052, 5.4490, 5.3987,
  5.3480, 5.2962, 5.2446, 5.1927, 5.1404,
  5.0877, 5.0346, 2.5607, 2.0748, 1.7466,
  1.4878, 1.2999, 1.1403, 1.0157, 0.9181,
  0.8311, 0.7579, 0.6979, 0.6502, 0.6029,
  0.5609, 0.5257, 0.4911, 0.4589, 0.4304,
  0.4055, 0.3851, 0.3626, 0.3541, 0.3483,
  0.3380, 0.3328, 0.3248, 0.3213, 0.3199,
  0.3144, 0.3085, 0.3026, 0.2963, 0.2903,
  0.2878, 0.2828, 0.2756, 0.2695, 0.2669,
  0.2610, 0.2544, 0.2484, 0.2440, 0.2413,
  0.2346, 0.2283, 0.2215, 0.2183, 0.2119,
  0.2052, 0.2008, 0.1943, 0.1875, 0.1827,
  0.1757, 0.1690, 0.1625, 0.1557, 0.1498,
  0.1440, 0.1383, 0.1314, 0.1253, 0.1182,
  0.1120, 0.1044, 0.0972, 0.0908, 0.0842,
  0.0774, 0.0697, 0.0626, 0.0548, 0.0476,
  0.0396, 0.0321, 0.0239, 0.0162, 0.0082,
  0.0000
};

result_t results12[] = {
  {DROS_CORNER_JUMP, 2.588, 1.371, 0.2},
  {DROS_CORNER_JUMP, 2.971, 1.805, 0.1},
  {DROS_CORNER_CONVEX, 0.249, 1.723, 0.1},
  {DROS_CORNER_JUMP, -0.229, 2.173, 0.1},
  {DROS_CORNER_JUMP, -0.972, 2.832, 0.4},
  {DROS_CORNER_CONVEX, -0.640, 0.349, 0.3},
  {0, 0.0, 0.0, 0.0}
};

double test13x[361] = { 
  8.1830, 8.1827, 8.1818, 8.1802, 8.1780,
  8.1752, 8.1718, 8.1677, 8.1631, 8.1578,
  8.1519, 8.1453, 8.1382, 8.1304, 8.1220,
  8.1130, 8.1034, 8.0931, 8.0823, 8.0708,
  8.0587, 8.0460, 8.0327, 8.0187, 8.0042,
  7.9890, 7.9733, 7.5553, 7.1064, 6.7732,
  6.7238, 6.7194, 6.7115, 6.7117, 5.4270,
  5.0948, 4.9046, 4.7084, 4.5271, 2.4735,
  2.4404, 2.4007, 2.3750, 2.3540, 2.3309,
  2.3254, 2.3095, 2.3018, 2.2921, 2.2876,
  2.2857, 2.2917, 2.2865, 2.2982, 2.3229,
  2.7018, 2.6374, 2.5758, 2.5207, 2.4570,
  2.4032, 2.3497, 2.2998, 2.2493, 2.1964,
  2.1431, 2.0984, 2.0539, 2.0121, 1.9738,
  1.9316, 1.8904, 1.8502, 1.8095, 1.7754,
  1.7414, 1.7076, 1.6662, 1.6398, 1.6065,
  1.5727, 1.5459, 1.5132, 1.4792, 1.4610,
  1.4266, 1.3998, 1.3753, 1.3502, 1.3238,
  1.2982, 1.2736, 1.2559, 1.2308, 1.2065,
  1.1823, 1.1589, 1.1404, 1.1160, 1.0943,
  1.0780, 1.0565, 1.0422, 1.0278, 1.0146,
  1.0026, 0.9948, 0.9916, 0.9904, 0.9884,
  0.9860, 0.9850, 0.9825, 0.9808, 0.9776,
  0.9741, 0.9713, 0.9682, 0.9693, 0.9658,
  0.9610, 0.9563, 0.9604, 0.9543, 0.9488,
  0.9457, 0.9425, 0.9392, 0.9386, 0.9295,
  1.8291, 1.7844, 1.7421, 1.7011, 1.6571,
  1.6157, 1.5748, 1.5371, 1.4940, 1.4537,
  1.4170, 1.3770, 1.3371, 1.2975, 1.2611,
  1.2218, 1.1850, 1.1460, 1.1097, 1.0708,
  1.0345, 0.9988, 0.9604, 0.9247, 0.8890,
  0.8532, 0.8156, 0.6364, 0.6196, 0.6123,
  0.6022, 0.5935, 0.5826, 0.5720, 0.5449,
  0.5107, 0.4755, 0.4407, 0.3549, 0.3123,
  0.2834, 0.2544, 0.2263, 0.1980, 0.1693,
  0.1410, 0.1129, 0.0844, 0.0563, 0.0282,
  0.0000, -0.0281, -0.0561, -0.0842, -0.1122,
  -0.1567, -0.2003, -0.2336, -0.2669, -0.3000,
  -0.3335, -0.3667, -0.3999, -0.4331, -0.4662,
  -0.4994, -0.5325, -0.5655, -0.6002, -0.6328,
  -0.6661, -0.6989, -0.7325, -0.7135, -0.6926,
  -0.6703, -0.7237, -0.7526, -0.7821, -0.8095,
  -0.8388, -0.8688, -0.8958, -0.9253, -0.9549,
  -0.9848, -1.0120, -1.0420, -1.0718, -1.1022,
  -1.2289, -1.3704, -1.4062, -1.4414, -1.4771,
  -1.5127, -1.5481, -1.5854, -0.7911, -0.7809,
  -0.7806, -0.7741, -0.7759, -0.7679, -0.7650,
  -0.7605, -0.7596, -0.7549, -0.7524, -0.7505,
  -0.7505, -0.7481, -0.7458, -0.7451, -0.7435,
  -0.7468, -0.7505, -0.7578, -0.7689, -0.7777,
  -0.7869, -0.7996, -0.8141, -0.8304, -0.8431,
  -0.8584, -0.8742, -0.8890, -0.9043, -0.9204,
  -0.9359, -0.9521, -0.9611, -0.9833, -0.9997,
  -1.0161, -1.0319, -1.0484, -1.0642, -1.0878,
  -1.0974, -1.1191, -1.1351, -1.1526, -1.1702,
  -1.1929, -1.2098, -1.2328, -1.2498, -1.2729,
  -1.2908, -1.3141, -1.3382, -1.3547, -1.3798,
  -1.4026, -1.4280, -1.4453, -1.4692, -1.4955,
  -1.5203, -1.5452, -1.5719, -1.5977, -1.6228,
  -1.6581, -1.6834, -1.7198, -1.7486, -1.7750,
  -1.7935, -1.8373, -1.8699, -1.9053, -1.9460,
  -1.9709, -2.0128, -2.0548, -2.0879, -2.1301,
  -2.1715, -2.2148, -2.2583, -2.3027, -2.3583,
  -2.4012, -2.4524, -2.5038, -2.5636, -2.6152,
  -2.6706, -2.7327, -2.7978, -2.8620, -3.0148,
  -3.0281, -3.0267, -3.0174, -3.0270, -3.0297,
  -3.0253, -3.1378, -3.2233, -3.3012, -3.3762,
  -3.4746, -3.4284, -3.3837, -3.3640, -3.3431,
  -3.3444, -3.3514, -3.3473, -3.3577, -3.3768,
  -3.3957, -3.4342, -3.4994, -5.8528, -5.8489,
  -5.8437, -5.8399, -5.8328, -5.8391, -6.1206,
  -6.5368, -6.9857, -7.5314, -7.9518, -8.1827,
  -8.1830
};

double test13y[361] = { 
  0.0000, 0.0714, 0.1428, 0.2142, 0.2856,
  0.3569, 0.4283, 0.4996, 0.5708, 0.6420,
  0.7132, 0.7843, 0.8554, 0.9263, 0.9973,
  1.0681, 1.1389, 1.2095, 1.2801, 1.3506,
  1.4210, 1.4912, 1.5614, 1.6314, 1.7013,
  1.7711, 1.8408, 1.8139, 1.7718, 1.7517,
  1.8016, 1.8635, 1.9245, 1.9881, 1.6592,
  1.6064, 1.5936, 1.5754, 1.5588, 0.8759,
  0.8882, 0.8976, 0.9117, 0.9272, 0.9418,
  0.9632, 0.9803, 1.0009, 1.0205, 1.0425,
  1.0658, 1.0931, 1.1152, 1.1458, 1.1836,
  1.4065, 1.4023, 1.3986, 1.3972, 1.3901,
  1.3875, 1.3841, 1.3818, 1.3784, 1.3725,
  1.3653, 1.3627, 1.3594, 1.3572, 1.3565,
  1.3525, 1.3484, 1.3443, 1.3389, 1.3378,
  1.3362, 1.3341, 1.3253, 1.3279, 1.3243,
  1.3196, 1.3203, 1.3154, 1.3087, 1.3155,
  1.3073, 1.3053, 1.3051, 1.3039, 1.3009,
  1.2982, 1.2960, 1.3006, 1.2970, 1.2938,
  1.2902, 1.2871, 1.2890, 1.2838, 1.2813,
  1.2847, 1.2817, 1.2870, 1.2921, 1.2986,
  1.3067, 1.3201, 1.3400, 1.3632, 1.3856,
  1.4081, 1.4332, 1.4566, 1.4818, 1.5054,
  1.5291, 1.5545, 1.5799, 1.6132, 1.6397,
  1.6645, 1.6902, 1.7326, 1.7576, 1.7844,
  1.8166, 1.8497, 1.8838, 1.9243, 1.9487,
  3.9225, 3.9156, 3.9127, 3.9122, 3.9039,
  3.9006, 3.8979, 3.9022, 3.8921, 3.8881,
  3.8931, 3.8884, 3.8832, 3.8777, 3.8813,
  3.8750, 3.8759, 3.8688, 3.8700, 3.8613,
  3.8608, 3.8619, 3.8521, 3.8516, 3.8507,
  3.8486, 3.8373, 3.1279, 3.1873, 3.3037,
  3.4153, 3.5467, 3.6782, 3.8275, 3.8769,
  3.8795, 3.8729, 3.8680, 3.3764, 3.2430,
  3.2396, 3.2330, 3.2361, 3.2370, 3.2306,
  3.2299, 3.2320, 3.2249, 3.2255, 3.2269,
  3.2200, 3.2219, 3.2125, 3.2159, 3.2140,
  3.5896, 3.8228, 3.8189, 3.8167, 3.8122,
  3.8114, 3.8084, 3.8050, 3.8014, 3.7965,
  3.7933, 3.7888, 3.7840, 3.7898, 3.7814,
  3.7777, 3.7708, 3.7685, 3.5072, 3.2582,
  3.0236, 3.1345, 3.1349, 3.1370, 3.1300,
  3.1306, 3.1328, 3.1241, 3.1238, 3.1233,
  3.1234, 3.1147, 3.1143, 3.1126, 3.1126,
  3.3763, 3.6652, 3.6634, 3.6593, 3.6559,
  3.6521, 3.6470, 3.6462, 1.7768, 1.7135,
  1.6740, 1.6228, 1.5909, 1.5402, 1.5013,
  1.4609, 1.4286, 1.3903, 1.3574, 1.3264,
  1.2999, 1.2700, 1.2412, 1.2159, 1.1898,
  1.1723, 1.1557, 1.1449, 1.1399, 1.1315,
  1.1239, 1.1210, 1.1205, 1.1222, 1.1189,
  1.1186, 1.1190, 1.1176, 1.1168, 1.1165,
  1.1154, 1.1148, 1.1056, 1.1115, 1.1103,
  1.1089, 1.1065, 1.1047, 1.1020, 1.1070,
  1.0974, 1.0997, 1.0962, 1.0938, 1.0912,
  1.0931, 1.0893, 1.0907, 1.0864, 1.0872,
  1.0831, 1.0832, 1.0837, 1.0776, 1.0780,
  1.0763, 1.0760, 1.0695, 1.0674, 1.0668,
  1.0646, 1.0620, 1.0602, 1.0575, 1.0539,
  1.0563, 1.0519, 1.0539, 1.0507, 1.0455,
  1.0355, 1.0395, 1.0365, 1.0345, 1.0347,
  1.0260, 1.0256, 1.0245, 1.0183, 1.0160,
  1.0126, 1.0094, 1.0055, 1.0013, 1.0011,
  0.9946, 0.9908, 0.9863, 0.9841, 0.9778,
  0.9720, 0.9677, 0.9634, 0.9576, 0.9796,
  0.9547, 0.9254, 0.8938, 0.8680, 0.8402,
  0.8106, 0.8115, 0.8037, 0.7925, 0.7795,
  0.7703, 0.7287, 0.6884, 0.6539, 0.6196,
  0.5897, 0.5608, 0.5302, 0.5018, 0.4746,
  0.4471, 0.4217, 0.3987, 0.6152, 0.5632,
  0.5113, 0.4596, 0.4079, 0.3571, 0.3208,
  0.2854, 0.2439, 0.1972, 0.1388, 0.0714,
  0.0000
};

result_t results13[] = {
  {DROS_CORNER_CONVEX, 1.002, 1.284, 0.2},
  {DROS_CORNER_CONVEX_HIDDEN, 0.993, 1.949, 0.0},
  {0, 0.0, 0.0, 0.0}
};
  

//=============================================================================

int do_test(LaserCornerDetectorMain *d, double *x, double *y, 
	    unsigned int n, double thresh, result_t *results) {
  unsigned int nf;
  unsigned int i;
  int found;

  nf = d->ExtractCorners(x, y, n, thresh);
  DROS_DO(10000, d->DumpCorners(););
  
  while (results->type != 0) {
    found = FALSE;
    for (i = 0; i < nf; i++) {
      if ((sqrt((d->X(i) - results->x) * (d->X(i) - results->x) +
		(d->Y(i) - results->y) * (d->Y(i) - results->y)) < 0.1) &&
	  (d->CornerType(i) == results->type) && (d->Prob(i) >= results->prob))
	found = TRUE;
    }
    
    if (!found) {
      DROS_DEBUG(1, "FAILED: didn't find " 
		 << results->x << ", " << results->y);
      return -1;
    }
    
    results++;
  }
  
  return 0;
}

class RobotPose; void robot2sensor(RobotPose*,const RobotPose*){}

int do_test(LaserCornerDetectorMain *d, const char* fname, double thresh){
  const int MAX_SCAN_LENGTH = 361;
  const double MAX_SCAN_RANGE = 8.18;

  double range[MAX_SCAN_LENGTH];
  int i;

  FILE *f = fopen(fname,"r");
  if(f == NULL){
    DROS_DEBUG(1,"Failed to open file" << fname);
    return -1;
  }


  //Load Data.
  bool readOk = true;

  for(i = 0; readOk && i < MAX_SCAN_LENGTH; ++i){
    readOk = (fscanf(f,"%lf", range + i) == 1);
  }
  fclose(f);

  int n_points = i;
  double *x = new double[n_points];
  double *y = new double[n_points];

  const double DA = deg2rad(0.5);
  const double A0 = 0;
  double a;
  int n = 0;

  for(i = 0, a = A0; i < n_points; ++i, a += DA){
    if(range[i] < MAX_SCAN_RANGE){
      x[n] = range[i]*cos(a);
      y[n] = range[i]*sin(a);
      n += 1;
    }
  }

  int nf = d->ExtractCorners(x,y,n,thresh);

  DROS_DEBUG(1,"Found: "<<nf<<" corners (thesh "<<thresh<<")");

  printf("cc = [ ...\n");
  for(i = 0; i < nf; ++i){
    fprintf(stdout,"%+8.3f %+8.3f %+8.3f %+8.3f %+8.3f %+8.3f %d\n"
	    , d->X(i), d->Y(i)
	    , d->XTangentLeft(i) , d->YTangentLeft(i)
	    , d->XTangentRight(i), d->YTangentRight(i)
	    , d->CornerType(i) - 42000);

  }
  printf("];\n");


  delete[] x; delete[] y;

  return nf;
}

//=============================================================================
	    
int main(int argc, char *argv[]) {
  const char *dros_function_name = "main";
  const char *usage = "usage: TestLCD [-d debug_level] [-f scan] [thresh]";
  
  dros_program_name = argv[0];
  dros_debug_level = 100;

  char o;
  const char *optstring = "d:f:";
  opterr = 0;
  const char *scan_file = NULL;
  double thresh = 0.2;

  // Parse cmd line args!!
  o = getopt(argc, argv, optstring);
  while (o != -1) {
    switch (o) {
    case 'd':
      dros_debug_level = atoi(optarg);
      DROS_DEBUG(1, "dros_debug_level set to " << dros_debug_level);
      break;

    case 'f':
      scan_file =  optarg;
      break;

    case '?':
      DROS_DEBUG(1, "Incorrect command line arguments near " << 
		 (char) optopt);
      DROS_DEBUG(1, usage);
      return -1;
    }

    o = getopt(argc, argv, optstring);
  }

  if( optind < argc ){
    thresh = atof(argv[optind]);
  }

  LaserCornerDetectorMain d;

  if(scan_file != NULL){
    do_test(&d, scan_file,thresh);
    return 0;
  }


  if (do_test(&d, test0x, test0y, 361, 0.05, results0) < 0) {
    DROS_DEBUG(1, "test0 failed");
    return -1;
  }

  if (do_test(&d, test1x, test1y, 361, 0.05, results1) < 0) {
    DROS_DEBUG(1, "test1 failed");
    return -1;
  }

  //Convex
  if (do_test(&d, test3x, test3y, 100, 0.1, results3) < 0) {
    DROS_DEBUG(1, "test3 failed");
    return -1;
  }

  //Concave
  if (do_test(&d, test4x, test4y, 100, 0.1, results4) < 0) {
    DROS_DEBUG(1, "test4 failed");
    return -1;
  }

  //Discontinuity on right
  if (do_test(&d, test5x, test5y, 100, 0.1, results5) < 0) {
    DROS_DEBUG(1, "test5 failed");
    return -1;
  }
  bool failed = false;

  //Jump
  if (do_test(&d, test6x, test6y, 100, 0.1, results6) < 0) {
    DROS_DEBUG(1, "test6 failed");
    failed = true;
  }

  //Discontinuity on left
  if (do_test(&d, test7x, test7y, 100, 0.1, results7) < 0) {
    DROS_DEBUG(1, "test7 failed");
    failed = true;
  }

  if (do_test(&d, test8x, test8y, 361, 0.05, results8) < 0) {
    DROS_DEBUG(1, "test8 failed");
    failed = true;
  }

  if (do_test(&d, test9x, test9y, 361, 0.05, results9) < 0) {
    DROS_DEBUG(1, "test9 failed");
    failed = true;
  }

  if (do_test(&d, test10x, test10y, 361, 0.05, results10) < 0) {
    DROS_DEBUG(1, "test10 failed");
    failed = true;
  }

  if (do_test(&d, test11x, test11y, 361, 0.05, results11) < 0) {
    DROS_DEBUG(1, "test11 failed");
    failed = true;
  }

  if (do_test(&d, test12x, test12y, 361, 0.05, results12) < 0) {
    DROS_DEBUG(1, "test12 failed");
    failed = true;
  }

  /*
   * Would be nice to get the both convex corners close to the robot
   * from this scan.  Appears difficult because of the curvature.  
   */
  if (do_test(&d, test13x, test13y, 361, 0.05, results13) < 0) {
    DROS_DEBUG(1, "test13 failed");
    failed = true;
  }

  if(!failed) DROS_DEBUG(100, "All tests passed");

  return 0;
}

/*
 * Local Variables:
 * mode: C++
 * End:
 */

