% EKF Test:
obs = zeros(0,3); odo = zeros(0,3);
obs0 = [0.000000e+00 0.000000e+00 0.000000e+00 1.111111e-03 0.000000e+00 0.000000e+00 0.000000e+00 8.461595e-04 0.000000e+00 0.000000e+00 0.000000e+00 8.461595e-04];
  odo(1,:) = [0.000000e+00, 0.000000e+00, 7.853982e-01];
 obs(1,:) = [3.749378e+00, -1.402192e+00, 3.095167e-01];
x   = [2.913170e+00; -2.065669e+00; 1.142055e+00];
Sxx = [5.015708e-03, 4.095521e-03, -2.552211e-03; 4.095521e-03, 7.887487e-03, 1.809720e-03; -2.552211e-03, 1.809720e-03, 1.089463e-02];
% md2 = 3.641734e-30;
 odo(2,:) = [1.000000e-01, 9.933467e-02, 7.753315e-01];
 obs(2,:) = [3.726800e+00, -1.358904e+00, 3.054827e-01];
w(2) = 2.541177e+00;
x   = [2.991998e+00; -1.963624e+00; 1.130673e+00];
Sxx = [2.571083e-03, 2.050994e-03, -1.253315e-03; 2.050994e-03, 3.832078e-03, 9.270800e-04; -1.253315e-03, 9.270800e-04, 5.414977e-03];
% md2 = 1.545200e+00;
 odo(3,:) = [2.000000e-01, 1.947092e-01, 7.443299e-01];
 obs(3,:) = [3.672699e+00, -1.446711e+00, 2.718939e-01];
w(3) = 2.884009e+00;
x   = [2.964359e+00; -2.007036e+00; 1.082124e+00];
Sxx = [1.725036e-03, 1.364636e-03, -8.254255e-04; 1.364636e-03, 2.520799e-03, 6.195580e-04; -8.254255e-04, 6.195580e-04, 3.588731e-03];
% md2 = 2.290259e+00;
 odo(4,:) = [3.000000e-01, 2.823212e-01, 6.899997e-01];
 obs(4,:) = [3.663077e+00, -1.416301e+00, 2.901329e-01];
w(4) = 4.509844e+00;
x   = [2.955633e+00; -2.016999e+00; 1.073884e+00];
Sxx = [1.314214e-03, 1.021994e-03, -6.036445e-04; 1.021994e-03, 1.835190e-03, 4.647580e-04; -6.036445e-04, 4.647580e-04, 2.676261e-03];
% md2 = 3.335609e-01;
 odo(5,:) = [4.000000e-01, 3.586781e-01, 6.085123e-01];
 obs(5,:) = [3.699734e+00, -1.361179e+00, 2.528808e-01];
w(5) = 2.912003e+00;
x   = [2.965151e+00; -2.036729e+00; 1.043564e+00];
Sxx = [1.067689e-03, 8.121420e-04, -4.713756e-04; 8.121420e-04, 1.419773e-03, 3.742400e-04; -4.713756e-04, 3.742400e-04, 2.127964e-03];
% md2 = 2.857149e+00;
 odo(6,:) = [5.000000e-01, 4.207355e-01, 4.953673e-01];
 obs(6,:) = [3.612557e+00, -1.245372e+00, 2.549743e-01];
w(6) = 3.582095e+00;
x   = [2.981911e+00; -2.022269e+00; 1.020702e+00];
Sxx = [9.029557e-04, 6.716573e-04, -3.836090e-04; 6.716573e-04, 1.143225e-03, 3.125246e-04; -3.836090e-04, 3.125246e-04, 1.764214e-03];
% md2 = 2.211047e+00;
 odo(7,:) = [6.000000e-01, 4.660195e-01, 3.476413e-01];
 obs(7,:) = [3.543426e+00, -1.150093e+00, 2.809149e-01];
w(7) = 4.032715e+00;
x   = [2.982842e+00; -2.012343e+00; 1.015690e+00];
Sxx = [7.826508e-04, 5.700484e-04, -3.209277e-04; 5.700484e-04, 9.480913e-04, 2.676861e-04; -3.209277e-04, 2.676861e-04, 1.501936e-03];
% md2 = 1.607066e+00;
 odo(8,:) = [7.000000e-01, 4.927249e-01, 1.683582e-01];
 obs(8,:) = [3.552230e+00, -1.011269e+00, 2.823595e-01];
w(8) = 4.834650e+00;
x   = [2.980669e+00; -2.019062e+00; 1.012285e+00];
Sxx = [6.899214e-04, 4.916450e-04, -2.737431e-04; 4.916450e-04, 8.022786e-04, 2.345894e-04; -2.737431e-04, 2.345894e-04, 1.302186e-03];
% md2 = 2.945764e-01;
 odo(9,:) = [8.000000e-01, 4.997868e-01, -2.919123e-02];
 obs(9,:) = [3.462423e+00, -8.222156e-01, 3.363876e-01];
w(9) = 4.068868e+00;
x   = [2.978589e+00; -2.010680e+00; 1.028288e+00];
Sxx = [6.159689e-04, 4.290391e-04, -2.368881e-04; 4.290391e-04, 6.890924e-04, 2.091791e-04; -2.368881e-04, 2.091791e-04, 1.144766e-03];
% md2 = 1.847477e+00;
 odo(10,:) = [9.000000e-01, 4.869238e-01, -2.234094e-01];
 obs(10,:) = [3.384896e+00, -6.853364e-01, 3.117240e-01];
w(10) = 4.371056e+00;
x   = [2.970430e+00; -2.014892e+00; 1.029775e+00];
Sxx = [5.546494e-04, 3.774188e-04, -2.070763e-04; 3.774188e-04, 5.994202e-04, 1.895478e-04; -2.070763e-04, 1.895478e-04, 1.015839e-03];
% md2 = 1.469853e+00;
 odo(11,:) = [1.000000e+00, 4.546487e-01, -3.943481e-01];
 obs(11,:) = [3.290318e+00, -4.917158e-01, 2.876602e-01];
w(11) = 4.358143e+00;
x   = [2.975011e+00; -2.010544e+00; 1.019156e+00];
Sxx = [5.026236e-04, 3.339569e-04, -1.823203e-04; 3.339569e-04, 5.261762e-04, 1.733669e-04; -1.823203e-04, 1.733669e-04, 9.077658e-04];
% md2 = 1.554024e+00;
 odo(12,:) = [1.100000e+00, 4.042482e-01, -5.319215e-01];
 obs(12,:) = [3.241262e+00, -3.540136e-01, 3.095097e-01];
w(12) = 4.696771e+00;
x   = [2.980817e+00; -2.008637e+00; 1.015821e+00];
Sxx = [4.575849e-04, 2.970844e-04, -1.614523e-04; 2.970844e-04, 4.656587e-04, 1.591976e-04; -1.614523e-04, 1.591976e-04, 8.152556e-04];
% md2 = 1.038649e+00;
 odo(13,:) = [1.200000e+00, 3.377316e-01, -6.353842e-01];
 obs(13,:) = [3.046806e+00, -2.753917e-01, 3.731199e-01];
w(13) = 2.582987e+00;
x   = [2.981111e+00; -1.996588e+00; 1.024634e+00];
Sxx = [4.179186e-04, 2.652460e-04, -1.435782e-04; 2.652460e-04, 4.148971e-04, 1.467407e-04; -1.435782e-04, 1.467407e-04, 7.347064e-04];
% md2 = 5.309827e+00;
 odo(14,:) = [1.300000e+00, 2.577507e-01, -7.084798e-01];
 obs(14,:) = [3.031853e+00, -2.628946e-01, 3.377957e-01];
w(14) = 3.802413e+00;
x   = [2.973669e+00; -2.008084e+00; 1.023707e+00];
Sxx = [3.821697e-04, 2.370855e-04, -1.279539e-04; 2.370855e-04, 3.715858e-04, 1.357268e-04; -1.279539e-04, 1.357268e-04, 6.629378e-04];
% md2 = 2.817161e+00;
 odo(15,:) = [1.400000e+00, 1.674941e-01, -7.556587e-01];
 obs(15,:) = [2.850957e+00, -2.090476e-01, 3.195161e-01];
w(15) = 4.072089e+00;
x   = [2.972433e+00; -2.012586e+00; 1.011339e+00];
Sxx = [3.498344e-04, 2.119400e-04, -1.141697e-04; 2.119400e-04, 3.338870e-04, 1.257791e-04; -1.141697e-04, 1.257791e-04, 5.989051e-04];
% md2 = 2.736685e+00;
 odo(16,:) = [1.500000e+00, 7.056000e-02, -7.803693e-01];
 obs(16,:) = [2.755027e+00, -1.759728e-01, 3.744459e-01];
w(16) = 5.577292e+00;
x   = [2.972332e+00; -2.013739e+00; 1.011175e+00];
Sxx = [3.202847e-04, 1.893726e-04, -1.019477e-04; 1.893726e-04, 3.007547e-04, 1.164412e-04; -1.019477e-04, 1.164412e-04, 5.412215e-04];
% md2 = 1.018456e-01;
 odo(17,:) = [1.600000e+00, -2.918707e-02, -7.845448e-01];
 obs(17,:) = [2.603861e+00, -1.821273e-01, 4.030153e-01];
w(17) = 5.671230e+00;
x   = [2.972030e+00; -2.012615e+00; 1.011931e+00];
Sxx = [2.930521e-04, 1.689214e-04, -9.102776e-05; 1.689214e-04, 2.714489e-04, 1.077518e-04; -9.102776e-05, 1.077518e-04, 4.888466e-04];
% md2 = 1.605771e-01;
 odo(18,:) = [1.700000e+00, -1.277706e-01, -7.685186e-01];
 obs(18,:) = [2.513301e+00, -1.339072e-01, 3.739599e-01];
w(18) = 1.391410e+00;
x   = [2.985489e+00; -2.006917e+00; 1.003182e+00];
Sxx = [2.678175e-04, 1.502712e-04, -8.121777e-05; 1.502712e-04, 2.453056e-04, 9.960907e-05; -8.121777e-05, 9.960907e-05, 4.411169e-04];
% md2 = 8.100261e+00;
 odo(19,:) = [1.800000e+00, -2.212602e-01, -7.310213e-01];
 obs(19,:) = [2.333172e+00, -2.160868e-01, 4.247852e-01];
w(19) = 4.720312e+00;
x   = [2.992001e+00; -2.001059e+00; 9.984386e-01];
Sxx = [2.445148e-04, 1.333769e-04, -7.248659e-05; 1.333769e-04, 2.219601e-04, 9.184214e-05; -7.248659e-05, 9.184214e-05, 3.978174e-04];
% md2 = 2.303957e+00;
 odo(20,:) = [1.900000e+00, -3.059289e-01, -6.692091e-01];
 obs(20,:) = [2.207816e+00, -3.165090e-01, 5.048869e-01];
w(20) = 4.205331e+00;
x   = [2.992642e+00; -1.994446e+00; 1.004669e+00];
Sxx = [2.229405e-04, 1.179816e-04, -6.463043e-05; 1.179816e-04, 2.009658e-04, 8.453682e-05; -6.463043e-05, 8.453682e-05, 3.585318e-04];
% md2 = 3.649062e+00;
 odo(21,:) = [2.000000e+00, -3.784013e-01, -5.789324e-01];
 obs(21,:) = [2.175243e+00, -3.823353e-01, 4.980405e-01];
w(21) = 3.850542e+00;
x   = [3.000310e+00; -1.988399e+00; 1.008073e+00];
Sxx = [2.029929e-04, 1.039418e-04, -5.751120e-05; 1.039418e-04, 1.820847e-04, 7.781135e-05; -5.751120e-05, 7.781135e-05, 3.230154e-04];
% md2 = 4.220658e+00;
 odo(22,:) = [2.100000e+00, -4.357879e-01, -4.558259e-01];
 obs(22,:) = [2.125343e+00, -6.027431e-01, 4.728493e-01];
w(22) = 3.339656e+00;
x   = [2.998871e+00; -1.995255e+00; 1.005497e+00];
Sxx = [1.847964e-04, 9.133768e-05, -5.112441e-05; 9.133768e-05, 1.652509e-04, 7.167552e-05; -5.112441e-05, 7.167552e-05, 2.913276e-04];
% md2 = 5.352423e+00;
 odo(23,:) = [2.200000e+00, -4.758010e-01, -2.981705e-01];
 obs(23,:) = [1.983737e+00, -7.546611e-01, 4.938072e-01];
w(23) = 5.039167e+00;
x   = [3.004229e+00; -1.993970e+00; 9.992150e-01];
Sxx = [1.684713e-04, 8.021293e-05, -4.537852e-05; 8.021293e-05, 1.503719e-04, 6.622128e-05; -4.537852e-05, 6.622128e-05, 2.634987e-04];
% md2 = 2.419779e+00;
 odo(24,:) = [2.300000e+00, -4.968455e-01, -1.116858e-01];
 obs(24,:) = [1.957531e+00, -1.040782e+00, 5.587148e-01];
w(24) = 5.803478e+00;
x   = [3.000883e+00; -1.995970e+00; 1.003022e+00];
Sxx = [1.539777e-04, 7.052660e-05, -4.026538e-05; 7.052660e-05, 1.373226e-04, 6.137605e-05; -4.026538e-05, 6.137605e-05, 2.392248e-04];
% md2 = 1.104968e+00;
 odo(25,:) = [2.400000e+00, -4.980823e-01, 8.727670e-02];
 obs(25,:) = [1.864853e+00, -1.275506e+00, 4.954586e-01];
w(25) = 4.013143e+00;
x   = [3.002783e+00; -1.998013e+00; 9.928310e-01];
Sxx = [1.412778e-04, 6.220160e-05, -3.570800e-05; 6.220160e-05, 1.260143e-04, 5.722180e-05; -3.570800e-05, 5.722180e-05, 2.182954e-04];
% md2 = 4.550805e+00;
 odo(26,:) = [2.500000e+00, -4.794621e-01, 2.764014e-01];
 obs(26,:) = [1.870899e+00, -1.516064e+00, 5.490831e-01];
w(26) = 6.370425e+00;
x   = [3.004335e+00; -1.997105e+00; 9.913344e-01];
Sxx = [1.303621e-04, 5.517590e-05, -3.172187e-05; 5.517590e-05, 1.162579e-04, 5.364642e-05; -3.172187e-05, 5.364642e-05, 2.004597e-04];
% md2 = 2.680865e-01;
 odo(27,:) = [2.600000e+00, -4.417273e-01, 4.381452e-01];
 obs(27,:) = [1.935477e+00, -1.776035e+00, 4.885016e-01];
w(27) = 2.922869e+00;
x   = [3.001643e+00; -2.004158e+00; 9.861458e-01];
Sxx = [1.210700e-04, 4.927877e-05, -2.825638e-05; 4.927877e-05, 1.078785e-04, 5.063954e-05; -2.825638e-05, 5.063954e-05, 1.853836e-04];
% md2 = 6.492475e+00;
 odo(28,:) = [2.700000e+00, -3.863822e-01, 5.655391e-01];
 obs(28,:) = [1.880862e+00, -1.921809e+00, 5.439251e-01];
w(28) = 5.427958e+00;
x   = [3.005312e+00; -2.000791e+00; 9.847370e-01];
Sxx = [1.132730e-04, 4.434321e-05, -2.528198e-05; 4.434321e-05, 1.006593e-04, 4.815285e-05; -2.528198e-05, 4.815285e-05, 1.728169e-04];
% md2 = 2.001602e+00;
 odo(29,:) = [2.800000e+00, -3.156333e-01, 6.596635e-01];
 obs(29,:) = [1.981674e+00, -2.084808e+00, 4.710221e-01];
w(29) = 4.206914e+00;
x   = [3.006799e+00; -2.003621e+00; 9.797097e-01];
Sxx = [1.066931e-04, 4.015739e-05, -2.274126e-05; 4.015739e-05, 9.438310e-05, 4.608916e-05; -2.274126e-05, 4.608916e-05, 1.623179e-04];
% md2 = 4.143737e+00;
 odo(30,:) = [2.900000e+00, -2.323011e-01, 7.247570e-01];
 obs(30,:) = [2.011922e+00, -2.259530e+00, 4.845217e-01];
w(30) = 5.714423e+00;
x   = [3.005672e+00; -2.004495e+00; 9.777127e-01];
Sxx = [1.011413e-04, 3.655516e-05, -2.059448e-05; 3.655516e-05, 8.886174e-05, 4.438043e-05; -2.059448e-05, 4.438043e-05, 1.536133e-04];
% md2 = 1.273672e+00;
 odo(31,:) = [3.000000e+00, -1.397077e-01, 7.650814e-01];
 obs(31,:) = [2.105964e+00, -2.291633e+00, 4.921163e-01];
w(31) = 5.263120e+00;
x   = [3.008171e+00; -2.003238e+00; 9.780107e-01];
Sxx = [9.639424e-05, 3.338961e-05, -1.877663e-05; 3.338961e-05, 8.395341e-05, 4.296161e-05; -1.877663e-05, 4.296161e-05, 1.463753e-04];
% md2 = 1.971212e+00;
 odo(32,:) = [3.100000e+00, -4.154470e-02, 7.836662e-01];
 obs(32,:) = [2.242175e+00, -2.425731e+00, 4.717885e-01];
w(32) = 4.781732e+00;
x   = [3.005145e+00; -2.005585e+00; 9.801742e-01];
Sxx = [9.228133e-05, 3.056400e-05, -1.723653e-05; 3.056400e-05, 7.955640e-05, 4.176858e-05; -1.723653e-05, 4.176858e-05, 1.403191e-04];
% md2 = 2.558829e+00;
 odo(33,:) = [3.200000e+00, 5.827460e-02, 7.819790e-01];
 obs(33,:) = [2.270966e+00, -2.432567e+00, 4.431071e-01];
w(33) = 5.801156e+00;
x   = [3.006633e+00; -2.004309e+00; 9.796689e-01];
Sxx = [8.866472e-05, 2.800047e-05, -1.592605e-05; 2.800047e-05, 7.558967e-05, 4.075748e-05; -1.592605e-05, 4.075748e-05, 1.352273e-04];
% md2 = 6.064489e-01;
 odo(34,:) = [3.300000e+00, 1.557707e-01, 7.598850e-01];
 obs(34,:) = [2.411281e+00, -2.449519e+00, 4.284013e-01];
w(34) = 5.625753e+00;
x   = [3.006586e+00; -2.004967e+00; 9.802694e-01];
Sxx = [8.543778e-05, 2.565310e-05, -1.480831e-05; 2.565310e-05, 7.198828e-05, 3.987206e-05; -1.480831e-05, 3.987206e-05, 1.308856e-04];
% md2 = 7.273710e-01;
 odo(35,:) = [3.400000e+00, 2.470567e-01, 7.156481e-01];
 obs(35,:) = [2.521479e+00, -2.395435e+00, 4.282077e-01];
w(35) = 2.593168e+00;
x   = [3.007943e+00; -2.005436e+00; 9.815548e-01];
Sxx = [8.252001e-05, 2.348714e-05, -1.384681e-05; 2.348714e-05, 6.870875e-05, 3.908502e-05; -1.384681e-05, 3.908502e-05, 1.271412e-04];
% md2 = 6.349403e+00;
 odo(36,:) = [3.500000e+00, 3.284933e-01, 6.459939e-01];
 obs(36,:) = [2.582606e+00, -2.401747e+00, 3.991625e-01];
w(36) = 5.500738e+00;
x   = [3.008667e+00; -2.005249e+00; 9.818792e-01];
Sxx = [7.984995e-05, 2.148065e-05, -1.300964e-05; 2.148065e-05, 6.571733e-05, 3.837354e-05; -1.300964e-05, 3.837354e-05, 1.238634e-04];
% md2 = 6.992460e-01;
 odo(37,:) = [3.600000e+00, 3.968339e-01, 5.465376e-01];
 obs(37,:) = [2.628583e+00, -2.348501e+00, 3.844304e-01];
w(37) = 5.274796e+00;
x   = [3.010187e+00; -2.003654e+00; 9.817479e-01];
Sxx = [7.737644e-05, 1.961435e-05, -1.227009e-05; 1.961435e-05, 6.298357e-05, 3.771944e-05; -1.227009e-05, 3.771944e-05, 1.209478e-04];
% md2 = 1.032580e+00;
 odo(38,:) = [3.700000e+00, 4.493541e-01, 4.132892e-01];
 obs(38,:) = [2.727458e+00, -2.225324e+00, 4.282755e-01];
w(38) = 2.984440e+00;
x   = [3.011401e+00; -2.002006e+00; 9.845871e-01];
Sxx = [7.505991e-05, 1.787500e-05, -1.160457e-05; 1.787500e-05, 6.048365e-05, 3.711023e-05; -1.160457e-05, 3.711023e-05, 1.183104e-04];
% md2 = 5.418434e+00;
 odo(39,:) = [3.800000e+00, 4.839598e-01, 2.461640e-01];
 obs(39,:) = [2.777229e+00, -2.125528e+00, 3.424460e-01];
w(39) = 5.450346e+00;
x   = [3.011705e+00; -2.002030e+00; 9.835534e-01];
Sxx = [7.286853e-05, 1.625312e-05, -1.098960e-05; 1.625312e-05, 5.820174e-05, 3.654242e-05; -1.098960e-05, 3.654242e-05, 1.158868e-04];
% md2 = 4.847419e-01;
 odo(40,:) = [3.900000e+00, 4.992717e-01, 5.390315e-02];
 obs(40,:) = [2.861054e+00, -2.039131e+00, 3.888444e-01];
w(40) = 1.285450e+00;
x   = [3.008678e+00; -2.002245e+00; 9.862264e-01];
Sxx = [7.077657e-05, 1.473684e-05, -1.041407e-05; 1.473684e-05, 5.611485e-05, 3.600473e-05; -1.041407e-05, 3.600473e-05, 1.136297e-04];
% md2 = 8.176795e+00;
 odo(41,:) = [4.000000e+00, 4.946791e-01, -1.444861e-01];
 obs(41,:) = [2.874948e+00, -1.799940e+00, 3.915000e-01];
w(41) = 4.628875e+00;
x   = [3.008392e+00; -2.001870e+00; 9.881931e-01];
Sxx = [6.875973e-05, 1.331944e-05, -9.858774e-06; 1.331944e-05, 5.421290e-05, 3.549805e-05; -9.858774e-06, 3.549805e-05, 1.114991e-04];
% md2 = 1.965372e+00;
